<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.yanqi.cf","root":"/","scheme":"Gemini","version":"8.0.0-rc.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
<meta property="og:type" content="website">
<meta property="og:title" content="blyanqi@163.com">
<meta property="og:url" content="http://blog.yanqi.cf/page/6/index.html">
<meta property="og:site_name" content="blyanqi@163.com">
<meta property="og:description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="yan qi">
<meta property="article:tag" content="运维、自动化、devops、容器架构">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://blog.yanqi.cf/page/6/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>blyanqi@163.com</title>
  


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?829697829f3ae7ddf2c38de42e2f8f5d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">blyanqi@163.com</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.yanqi.cf/2020/06/WebEnder/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yan qi">
      <meta itemprop="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blyanqi@163.com">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/WebEnder/" class="post-title-link" itemprop="url">WebEnder</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-21 13:15:51" itemprop="dateCreated datePublished" datetime="2020-06-21T13:15:51+08:00">2020-06-21</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>0</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.yanqi.cf/2020/06/WebFronter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yan qi">
      <meta itemprop="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blyanqi@163.com">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/WebFronter/" class="post-title-link" itemprop="url">WebFronter</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-21 13:15:42" itemprop="dateCreated datePublished" datetime="2020-06-21T13:15:42+08:00">2020-06-21</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>0</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.yanqi.cf/2020/06/WebServices/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yan qi">
      <meta itemprop="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blyanqi@163.com">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/WebServices/" class="post-title-link" itemprop="url">WebServices</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-21 13:10:32" itemprop="dateCreated datePublished" datetime="2020-06-21T13:10:32+08:00">2020-06-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-07-11 11:29:28" itemprop="dateModified" datetime="2020-07-11T11:29:28+08:00">2020-07-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>0</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.yanqi.cf/2020/06/C-%E8%AF%AD%E8%A8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yan qi">
      <meta itemprop="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blyanqi@163.com">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/C-%E8%AF%AD%E8%A8%80/" class="post-title-link" itemprop="url">C++语言</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-19 09:23:25" itemprop="dateCreated datePublished" datetime="2020-06-19T09:23:25+08:00">2020-06-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-07-11 11:34:46" itemprop="dateModified" datetime="2020-07-11T11:34:46+08:00">2020-07-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>编译器<br>g++ -v</p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Hello, world!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><p>对象 - 对象具有状态和行为。<br>类 - 类可以定义为描述对象行为/状态的模板/蓝图。<br>方法 - 从基本上说，一个方法表示一种行为。<br>即时变量 - 每个对象都有其独特的即时变量。<br>命名空间是 C++ 中一个相对新的概念。</p>
<h3 id="基本的内置类型"><a href="#基本的内置类型" class="headerlink" title="基本的内置类型"></a>基本的内置类型</h3><p>宽字符型 wchar_t</p>
<p>类型限定符<br>const    const 类型的对象在程序执行期间不能被修改改变。<br>volatile    修饰符 volatile 告诉编译器不需要优化volatile声明的变量，让程序可以直接从内存中读取变量。对于一般的变量编译器会对变量进行优化，将内存中的变量值放在寄存器中以加快读写效率。<br>restrict    由 restrict 修饰的指针是唯一一种访问它所指向的对象的方式。只有 C99 增加了新的类型限定符 restrict。</p>
<p>存储类<br>mutable<br>thread_local (C++11)<br>使用 thread_local 说明符声明的变量仅可在它在其上创建的线程上访问。 变量在创建线程时创建，并在销毁线程时销毁。</p>
<blockquote>
<p>从 C++ 17 开始，auto 关键字不再是 C++ 存储类说明符，且 register 关键字被弃用。</p>
</blockquote>
<h2 id="杂项运算符"><a href="#杂项运算符" class="headerlink" title="杂项运算符"></a>杂项运算符</h2><p>sizeof    sizeof 运算符返回变量的大小。例如，sizeof(a) 将返回 4，其中 a 是整数。<br>Condition ? X : Y    条件运算符。如果 Condition 为真 ? 则值为 X : 否则值为 Y。<br>,    逗号运算符会顺序执行一系列运算。整个逗号表达式的值是以逗号分隔的列表中的最后一个表达式的值。<br>.（点）和 -&gt;（箭头）    成员运算符用于引用类、结构和共用体的成员。<br>Cast    强制转换运算符把一种数据类型转换为另一种数据类型。例如，int(2.2000) 将返回 2。<br>&amp;    指针运算符 &amp; 返回变量的地址。例如 &a; 将给出变量的实际地址。</p>
<ul>
<li>指针运算符 <em> 指向一个变量。例如，</em>var; 将指向变量 var。</li>
</ul>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引用传递</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span> <span class="comment">// 声明引用类型 &amp;x</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> temp;</span><br><span class="line">   temp = x; <span class="comment">/* 保存地址 x 的值 */</span></span><br><span class="line">   x = y;    <span class="comment">/* 把 y 赋值给 x */</span></span><br><span class="line">   y = temp; <span class="comment">/* 把 x 赋值给 y  */</span></span><br><span class="line">  </span><br><span class="line">   <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">swap(a, b);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指针传递</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *x, <span class="keyword">int</span> *y)</span> <span class="comment">//此处的 *x 是定义</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> temp;</span><br><span class="line">   temp = *x;    <span class="comment">// 此处的 *x 是取值 ，上面是定义。这也是指针最容易搞混的地方</span></span><br><span class="line">   *x = *y;        <span class="comment">/* 把 y 赋值给 x */</span></span><br><span class="line">   *y = temp;    <span class="comment">/* 把 x 赋值给 y */</span></span><br><span class="line">  </span><br><span class="line">   <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">swap(&amp;a, &amp;b);</span><br></pre></td></tr></table></figure>
<p>参数的默认值<br>int sum(int a, int b=20)</p>
<p>Lambda 函数与表达式</p>
<blockquote>
<p>C++11 提供了对匿名函数的支持,称为 Lambda 函数(也叫 Lambda 表达式)。<br><a href="int x, int y"></a> -&gt; int { int z = x + y; return z + x; }<br>传递方式   参数      返回值    函数体</p>
</blockquote>
<p>[]   // 沒有定义任何变量。使用未定义变量会引发错误。<br>[&amp;]  // 引用传递<br>[=]  // 值传递</p>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><p>C++ 引入的 string 类类型<br>string str1 = “Hello”;<br>string str2 = “World”;<br>str1 = str2 //复制<br>str3 = str1 + str2; //连接<br>len = str2.size(); //求长度</p>
<p>strcpy( str3, str1); //复制<br>strcat( str1, str2); //连接<br>len = strlen(str1); //求长度</p>
<h2 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h2><p>在变量声明的时候，如果没有确切的地址可以赋值，为指针变量赋一个 NULL 值是一个良好的编程习惯。<br>指针的算术运算</p>
<p><strong>引用 vs 指针</strong><br>不存在空引用。引用必须连接到一块合法的内存。<br>一旦引用被初始化为一个对象，就不能被指向到另一个对象。指针可以在任何时候指向到另一个对象。<br>引用必须在创建时被初始化。指针可以在任何时间被初始化。<br>int&amp;  r = i; // r 指向 i</p>
<p><strong>指针 vs 数组</strong></p>
<blockquote>
<p>数组名就是数组首地址</p>
</blockquote>
<p>int  var[MAX] = {10, 100, 200};<br>int  *ptr;<br>// 指针中的数组地址<br>ptr = var;</p>
<p><strong>指针数组</strong><br>const char *names[MAX] = {<br>                   “Zara Ali”,<br>                   “Hina Ali”,<br>                   “Nuha Ali”,<br>                   “Sara Ali”,<br>   };</p>
<p><strong>指向指针的指针</strong></p>
<p><strong>传递指针给函数</strong></p>
<p><strong>从函数返回指针</strong></p>
<h2 id="日期-amp-时间"><a href="#日期-amp-时间" class="headerlink" title="日期 &amp; 时间"></a>日期 &amp; 时间</h2><p>ctime<br>// 基于当前系统的当前日期/时间<br>time_t now = time(0);</p>
<p>// 把 now 转换为字符串形式<br>char* dt = ctime(&amp;now);</p>
<p> // 把 now 转换为 tm 结构<br>tm *gmtm = gmtime(&amp;now);<br>dt = asctime(gmtm);</p>
<h2 id="基本的输入输出"><a href="#基本的输入输出" class="headerlink" title="基本的输入输出"></a>基本的输入输出</h2><p>iostream<br>iomanip<br>fstream</p>
<p>cout &lt;&lt; “请输入您的名称： “;<br>cin &gt;&gt; name;<br>cerr &lt;&lt;<br>clog &lt;&lt;</p>
<h2 id="类定义"><a href="#类定义" class="headerlink" title="类定义"></a>类定义</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Box</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">public</span>:</span><br><span class="line">      <span class="keyword">double</span> length;   <span class="comment">// 盒子的长度</span></span><br><span class="line">      <span class="keyword">double</span> breadth;  <span class="comment">// 盒子的宽度</span></span><br><span class="line">      <span class="keyword">double</span> <span class="built_in">height</span>;   <span class="comment">// 盒子的高度</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>类成员函数(方法)</strong><br>double Box::getVolume(void)<br>myBox.getVolume();<br><strong>类访问修饰符</strong><br>public everywhere<br>private class<br>protectd subclass</p>
<p><strong>构造函数 &amp; 析构函数</strong><br>class Line<br>{<br>   public:<br>      void setLength( double len );<br>      double getLength( void );<br>      Line();  // 这是构造函数</p>
<p>   private:<br>      double length;<br>};</p>
<p>// 构造函数,与类同名<br>Line::Line(void)</p>
<p>// 析构函数,与类同名前加波浪号<br>Line::~Line(void)<br>{<br>    cout &lt;&lt; “Object is being deleted” &lt;&lt; endl;<br>}</p>
<p><strong>拷贝构造函数</strong><br>如果在类中没有定义拷贝构造函数，编译器会自行定义一个。<br>Line( int len );             // 简单的构造函数<br>Line( const Line &amp;obj);      // 拷贝构造函数<br>~Line();                     // 析构函数</p>
<p>以下情况都会调用拷贝构造函数：<br>（1）一个对象以值传递的方式传入函数体（传参）<br>（2）一个对象以值传递的方式从函数返回（返回）<br>（3）一个对象需要通过另外一个对象进行初始化。（注入：把一个对象传递到另一个对象内部）</p>
<p><strong>友元函数</strong><br>类的友元函数是定义在类外部，但有权访问类的所有私有（private）成员和保护（protected）成员。<br>友元函数并不是成员函数。<br>// 在类中声明<br>friend void printWidth( Box box );<br>// 友元类（ClassTwo 的所有成员函数作为类 ClassOne 的友元）<br>friend class ClassTwo;</p>
<p><strong>内联函数</strong><br>inline int Max(int x, int y)<br>编译器会把该函数的代码副本放置在每个调用该函数的地方。<br>引入内联函数的目的是为了解决程序中函数调用的效率问题。<br>而对于其他的函数，都是在运行时候才被替代。这其实就是个空间代价换时间的i节省。</p>
<p><strong>this 指针</strong><br>每一个对象都能通过 this 指针来访问自己的地址。this 指针是所有成员函数的隐含参数。<br>在类中<br>this-&gt;Volume()</p>
<p><strong>指向类的指针</strong><br>Box Box2(8.5, 6.0, 2.0);    // Declare box2<br>Box *ptrBox;                // Declare pointer to a class.</p>
<p>// 保存第一个对象的地址<br>ptrBox = &Box1;<br>ptrBox-&gt;Volume()</p>
<p><strong>类的静态成员</strong><br>作为类的计数器很方便<br>静态属性<br>static int objectCount;<br>当我们声明类的成员为静态时，这意味着无论创建多少个类的对象，静态成员都只有一个副本。</p>
<p>静态方法<br>static int getCount()<br>{<br> return objectCount;<br>}</p>
<p><strong>继承</strong><br>// 单继承<br>class Rectangle: public Shape<br>// 多继承<br>class Rectangle: public Shape, public PaintCost<br>public 是继承基类成员后采用修饰符<br>派生类（子类）<br>基类(父类)<br>下列情况不能被继承：<br>    基类的构造函数、析构函数和拷贝构造函数。<br>    基类的重载运算符。<br>    基类的友元函数。</p>
<p><strong>函数重载和运算符重载</strong><br>//函数重载<br>void print(int i)<br>void print(double  f)<br>void print(char c[])<br>//运算符重载(自定义一些运算，使用内置的运算符)<br>Box operator+(const Box&amp; b)<br>Box3 = Box1 + Box2;</p>
<p>不可重载的运算符列表<br>    .：成员访问运算符<br>    .<em>, -&gt;</em>：成员指针访问运算符<br>    ::：域运算符<br>    sizeof：长度运算符<br>    ?:：条件运算符</p>
<pre><code>#： 预处理符号
</code></pre><p><strong>多态</strong><br>多态按字面的意思就是多种形态。<br>当类之间存在层次结构，并且类之间是通过继承关联时，就会用到多态。</p>
<p>虚函数<br>告诉编译器不要静态链接到该函数。<br>纯虚函数（只定义不实现）<br>virtual int area() = 0;</p>
<p><strong>数据抽象</strong><br>只向外界提供关键信息，并隐藏其后台的实现细节，即只表现必要的信息而不呈现细节。<br>数据抽象是一种依赖于接口和实现分离的编程（设计）技术。</p>
<p><strong>数据封装</strong><br>把数据和操作数据的函数捆绑在一起的机制。<br>通常情况下，我们都会设置类成员状态为私有（private），除非我们真的需要将其暴露，这样才能保证良好的封装性。<br>这通常应用于数据成员，但它同样适用于所有成员，包括虚函数。</p>
<p><strong>接口（抽象类）</strong><br>如果类中至少有一个函数被声明为纯虚函数，则这个类就是抽象类。</p>
<p><strong>文件和流</strong><br>ofstream outfile; //写<br>    outfile &lt;&lt; data &lt;&lt; endl;<br>ifstream infile;  //读<br>    infile &gt;&gt; data;</p>
<p>fstream<br>open()</p>
<p>cin.getline(data, 100);<br>close()</p>
<p>open参数<br>ios::app //追加<br>ios::ate //定位到文件尾<br>ios::in  //读取<br>ios::out //写入<br>ios::trunc //从头开始重写</p>
<p><strong>异常处理</strong><br>throw // 抛出一个异常<br>catch // 捕获异常<br>try   // follow 异常</p>
<p>标准的异常<br>std::exception</p>
<p>定义新的异常<br>struct MyException : public exception<br>what() //异常类提供的一个公共方法，它已被所有子异常类重载</p>
<p><strong>动态内存</strong><br>栈：在函数内部声明的所有变量都将占用栈内存。<br>堆：这是程序中未使用的内存，在程序运行时可用于动态分配内存。</p>
<p>new 和 delete 运算符<br>pvalue  = new double;   // 为变量请求内存,放到堆里<br>pvalue  = new char[20]; // 为变量请求内存<br>Box* myBoxArray = new Box[4]; //对象<br>delete pvalue;        // 释放 pvalue 所指向的内存</p>
<p>new 与 malloc() 函数相比，其主要的优点是，new 不只是分配了内存，它还创建了对象。</p>
<p><strong>命名空间</strong></p>
<blockquote>
<p>命名空间可以嵌套</p>
</blockquote>
<p>// 声明命名空间<br>namespace first_space{<br>   void func(){<br>      cout &lt;&lt; “Inside first_space” &lt;&lt; endl;<br>   }<br>}</p>
<p>// 调用命名空间中的函数<br>first_space::func();</p>
<p>// using namespace<br>using namespace first_space;<br>func();</p>
<p><strong>模板</strong><br>函数模板<br>template <typename t><br>类模板<br>template <class t></class></typename></p>
<p>// 定义<br>template <class t><br>class Stack {<br>  private:<br>    vector<T> elems;     // 元素 </T></class></p>
<p>  public:<br>    void push(T const&amp;);  // 入栈<br>    void pop();               // 出栈<br>    T top() const;            // 返回栈顶元素<br>    bool empty() const{       // 如果为空则返回真。<br>        return elems.empty();<br>    }<br>}; </p>
<p>// 使用<br>Stack<int>         intStack;  // int 类型的栈<br>Stack<string> stringStack;    // string 类型的栈 </string></int></p>
<p><strong>预处理器指令</strong><br>预定义宏<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__LINE__	这会在程序编译时包含当前行号。</span><br><span class="line">__FILE__	这会在程序编译时包含当前文件名。</span><br><span class="line">__DATE__	这会包含一个形式为 <span class="built_in">month</span>/<span class="built_in">day</span>/<span class="built_in">year</span> 的字符串，它表示把源文件转换为目标代码的日期。</span><br><span class="line">__TIME__	这会包含一个形式为 <span class="built_in">hour</span>:<span class="built_in">minute</span>:<span class="built_in">second</span> 的字符串，它表示程序被编译的时间。</span><br></pre></td></tr></table></figure></p>
<p><strong>信号处理</strong><br>csiganl<br>signal 函数，用来捕获突发事件。<br>第一个参数是一个整数，代表了信号的编号；第二个参数是一个指向信号处理函数的指针。</p>
<p>raise() 函数，生成信号</p>
<p>// 定义信号处理<br>void signalHandler( int signum )<br>// 注册信号 SIGINT 和信号处理程序<br>signal(SIGINT, signalHandler);</p>
<p>常见的信号<br>SIGABRT    程序的异常终止，如调用 abort。<br>SIGFPE    错误的算术运算，比如除以零或导致溢出的操作。<br>SIGILL    检测非法指令。<br>SIGINT    程序终止(interrupt)信号。<br>SIGSEGV    非法访问内存。<br>SIGTERM    发送到程序的终止请求。</p>
<p><strong>多线程</strong></p>
<h1 id="include"><a href="#include" class="headerlink" title="include "></a>include <pthread.h></pthread.h></h1><p>pthread_create() 创建线程<br>//参数依次是：创建的线程id，线程参数，调用的函数，传入的函数参数<br>int ret = pthread_create(&amp;tids[i], NULL, say_hello, NULL);</p>
<p>pthread_exit(status) 终止线程<br>pthread_exit(NULL);</p>
<p>连接和分离线程</p>
<blockquote>
<p>当创建一个线程时，它的某个属性会定义它是否是可连接的（joinable）或可分离的（detached）。只有创建时定义为可连接的线程才可以被连接。如果线程创建时被定义为可分离的，则它永远也不能被连接。</p>
</blockquote>
<p>// 站主线程角度<br>pthread_join() // 连接<br>pthread_detach() // 分离</p>
<p>pthread_attr_t attr;<br>pthread_attr_init(&amp;attr);<br>pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_JOINABLE);<br>pthread_attr_destroy(&amp;attr);</p>
<h2 id="Web-编程"><a href="#Web-编程" class="headerlink" title="Web 编程"></a>Web 编程</h2><p><strong>CGI</strong><br>CGI 规范目前是由 NCSA 维护的。<br>是一种用于外部网关程序与信息服务器（如 HTTP 服务器）对接的接口标准。<br>能够与 Web 服务器以及客户端进行交互的标准协议。</p>
<p><strong>HTTP 头信息</strong></p>
<p><strong>CGI 环境变量</strong></p>
<p><strong>C++ CGI 库</strong></p>
<p><strong>Get 方法</strong></p>
<p><strong>POST 方法</strong></p>
<p><strong>表单</strong></p>
<p><strong>cookie</strong></p>
<p><strong>文件上传</strong></p>
<p>httpd.conf<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">Directory</span> <span class="string">"/var/www/cgi-bin"</span>&gt;</span><br><span class="line">   AllowOverride <span class="keyword">None</span></span><br><span class="line">   <span class="keyword">Options</span> ExecCGI</span><br><span class="line">   <span class="keyword">Order</span> allow,deny</span><br><span class="line">   Allow from all</span><br><span class="line">&lt;/<span class="keyword">Directory</span>&gt;</span><br><span class="line"> </span><br><span class="line">&lt;<span class="keyword">Directory</span> <span class="string">"/var/www/cgi-bin"</span>&gt;</span><br><span class="line"><span class="keyword">Options</span> <span class="keyword">All</span></span><br><span class="line">&lt;/<span class="keyword">Directory</span>&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    </span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"Content-type:text/html\r\n\r\n"</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"&lt;html&gt;\n"</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"&lt;head&gt;\n"</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"&lt;title&gt;Hello World - 第一个 CGI 程序&lt;/title&gt;\n"</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"&lt;/head&gt;\n"</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"&lt;body&gt;\n"</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"&lt;h2&gt;Hello World! 这是我的第一个 CGI 程序&lt;/h2&gt;\n"</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"&lt;/body&gt;\n"</span>;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"&lt;/html&gt;\n"</span>;</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="STL"><a href="#STL" class="headerlink" title="STL"></a>STL</h2><p>C++ STL（标准模板库）是一套功能强大的 C++ 模板类<br>提供了通用的模板类和函数，这些模板类和函数可以实现多种流行和常用的算法和数据结构，如向量、链表、队列、栈。</p>
<p>容器（Containers）<br>算法（Algorithms）<br>迭代器（iterators）</p>
<h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><p><a href="http://www.hal9k.com/cug/" target="_blank" rel="noopener">Free Country</a><br><a href="https://www.thefreecountry.com/sourcecode/cpp.shtml" target="_blank" rel="noopener">C and C++ Users Group</a><br><a href="https://www.boost.org/" target="_blank" rel="noopener">Boost</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.yanqi.cf/2020/06/C%E8%AF%AD%E8%A8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yan qi">
      <meta itemprop="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blyanqi@163.com">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/C%E8%AF%AD%E8%A8%80/" class="post-title-link" itemprop="url">C语言</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-19 09:23:21" itemprop="dateCreated datePublished" datetime="2020-06-19T09:23:21+08:00">2020-06-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-07-11 11:34:44" itemprop="dateModified" datetime="2020-07-11T11:34:44+08:00">2020-07-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li><a href="http://www.mingw.org/" target="_blank" rel="noopener">mingw</a></li>
</ul>
<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>C11<br>C11（也被称为C1X）指ISO标准ISO/IEC 9899:2011，是当前最新的C语言标准。在它之前的C语言标准为C99。<br>多线程（Multithreading）支持</p>
<p>gcc 编译器<br>gcc -v</p>
<p>C 程序主要包括以下部分：<br>  预处理器指令 #开头<br>  函数<br>  变量<br>  语句 &amp; 表达式<br>  注释</p>
<h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/* 我的第一个 C 程序 */</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Hello, World! \n"</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>整数类型和浮点类型<br>枚举类型<br>void 类型<br>派生类型<br>  指针类型<br>  数组类型<br>  结构类型<br>  共用体类型<br>  函数类型</p>
<p>char,short,int,long(signed，unsigned)<br>float,long,double</p>
<p>sizeof(int)</p>
<p>void类型<br>函数返回为空<br>函数参数为空<br>指针指向 void<br>类型为 void <em> 的指针代表对象的地址，而不是类型。返回指向 void 的指针，可以转换为任何数据类型。内存分配函数 void </em>malloc( size_t size )。</p>
<h3 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h3><p>extern关键字声明变量名而不定义它。<br>如果需要在一个源文件中引用另外一个源文件中定义的变量，如果需要在一个源文件中引用另外一个源文件中定义的变量。</p>
<h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><p>常量是固定值，在程序执行期间不会改变。这些固定的值，又叫做字面量。<br>定义常量<br>  使用 #define 预处理器。<br>  使用 const 关键字。</p>
<h3 id="存储类"><a href="#存储类" class="headerlink" title="存储类"></a>存储类</h3><p>auto（所有局部变量默认的存储类）<br>register（定义存储在寄存器中而不是 RAM 中的局部变量，定义 ‘register’ 并不意味着变量将被存储在寄存器中，它意味着变量可能存储在寄存器中，这取决于硬件和实现的限制。）<br>static<br>static 存储类指示编译器在程序的生命周期内保持局部变量的存在。<br>static 修饰符也可以应用于全局变量。当 static 修饰全局变量时，会使变量的作用域限制在声明它的文件内。<br>extern<br>extern 存储类用于提供一个全局变量的引用，全局变量对所有的程序文件都是可见的。</p>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><p>b=++a 先加加再赋值<br>b=a++ 先赋值再加加</p>
<p>杂项运算符<br>sizeof() 返回变量的大小<br>&amp; 取变量的地址<br>* 指向一个变量<br>? : 条件表达式</p>
<p>运算符优先级<br>括号 &gt; 算术运算 &gt; 逻辑运算 &gt; 赋值运算</p>
<h3 id="控制语句"><a href="#控制语句" class="headerlink" title="控制语句"></a>控制语句</h3><p>while<br>for<br>do…while</p>
<p>break<br>continue<br>goto</p>
<p>switch(){case var:break;default:}</p>
<h3 id="输入输出"><a href="#输入输出" class="headerlink" title="输入输出"></a>输入输出</h3><p>enum color { red=1, green, blue };<br>enum  color favorite_color;<br>printf(“请输入你喜欢的颜色: (1. red, 2. green, 3. blue): “);<br>scanf(“%d”, &amp;favorite_color);</p>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>声明<br>return_type function_name( parameter list );<br>定义<br>return_type function_name( parameter list )<br>{<br>   body of the function<br>}<br>使用<br>function_name( parameter list )</p>
<p>作用域规则<br>局部变量<br>全局变量<br>形式参数</p>
<p>变量初始化<br>int    0<br>char    ‘\0’<br>float    0<br>double    0<br>pointer    NULL</p>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>type arrayName [ arraySize ];<br>初始化数组<br>double balance[5] = {1000.0, 2.0, 3.4, 7.0, 50.0};<br>访问数组元素<br>double salary = balance[9];</p>
<p>多维数组<br>type name[size1][size2]…[sizeN];</p>
<p>初始化二维数组<br>int a[3][4] = {<br> {0, 1, 2, 3} ,   /<em>  初始化索引号为 0 的行 </em>/<br> {4, 5, 6, 7} ,   /<em>  初始化索引号为 1 的行 </em>/<br> {8, 9, 10, 11}   /<em>  初始化索引号为 2 的行 </em>/<br>};</p>
<p>从函数返回数组<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 要生成和返回随机数的函数 */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> * <span class="title">getRandom</span><span class="params">( )</span> <span class="comment">// 此处返回定义为 * </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">int</span>  r[<span class="number">10</span>];</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  <span class="comment">/* 设置种子 */</span></span><br><span class="line">  srand( (<span class="keyword">unsigned</span>)time( <span class="literal">NULL</span> ) );</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i)</span><br><span class="line">  &#123;</span><br><span class="line">     r[i] = rand();</span><br><span class="line">     <span class="built_in">printf</span>( <span class="string">"r[%d] = %d\n"</span>, i, r[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> r; <span class="comment">//数组返回</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>指向数组的指针<br>double *p;<br>double balance[10];<br>p = balance;</p>
<p>传递数组给函数<br>void myFunction(int *param)<br>void myFunction(int param[10])<br>void myFunction(int param[])</p>
<h3 id="enum-枚举"><a href="#enum-枚举" class="headerlink" title="enum(枚举)"></a>enum(枚举)</h3><p>enum　枚举名　{枚举元素1,枚举元素2,……};<br>enum DAY<br>{<br>      MON=1, TUE, WED, THU, FRI, SAT, SUN<br>};</p>
<h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><p>&amp; 取地址<br>%p 打印<br>指针是一个变量，其值为另一个变量的地址。<br>int    <em>ip;    /</em> 一个整型的指针 <em>/<br>double </em>dp;    /<em> 一个 double 型的指针 </em>/<br>float  <em>fp;    /</em> 一个浮点型的指针 <em>/<br>char   </em>ch;     /<em> 一个字符型的指针 </em>/</p>
<p>NULL 指针<br>int  *ptr = NULL;<br>printf(“ptr 的地址是 %p\n”, ptr  );<br>ptr 的地址是 0x0</p>
<p>判断<br>if(ptr)     /<em> 如果 p 非空，则完成 </em>/<br>if(!ptr)    /<em> 如果 p 为空，则完成 </em>/</p>
<p>指针的算术运算<br>可以对指针进行四种算术运算：++、—、+、-。<br>指针的比较 ==、&lt; 和 &gt;</p>
<p>指针数组<br>int <em>ptr[MAX];<br>使用
</em>ptr[i];</p>
<p>指向指针的指针(多级指针)<br>int <strong>var; // 两级指针<br>int *</strong>var; // 三级指针</p>
<p>传递指针给函数<br>声明<br>void getSeconds(unsigned long *par);<br>使用<br>getSeconds( &amp;sec );</p>
<p>/<em> 函数声明 </em>/<br>double getAverage(int <em>arr, int size);<br>/</em> 带有 5 个元素的整型数组  <em>/<br>int balance[5] = {1000, 2, 3, 17, 50};<br>/</em> 传递一个指向数组的指针作为参数 */<br>avg = getAverage( balance, 5 ) ; // 数组名本身就是指针</p>
<p>从函数返回指针<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 要生成和返回随机数的函数 */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> * <span class="title">getRandom</span><span class="params">( )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">int</span>  r[<span class="number">10</span>];</span><br><span class="line">   <span class="keyword">int</span> i;</span><br><span class="line">   <span class="comment">/* 设置种子 */</span></span><br><span class="line">   srand( (<span class="keyword">unsigned</span>)time( <span class="literal">NULL</span> ) );</span><br><span class="line">   <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i)</span><br><span class="line">   &#123;</span><br><span class="line">      r[i] = rand();</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, r[i] );</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="函数指针-重中之重"><a href="#函数指针-重中之重" class="headerlink" title="函数指针(重中之重)"></a>函数指针(重中之重)</h3><p>函数指针是指向函数的指针变量。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数指针变量的声明</span></span><br><span class="line"><span class="comment">// 声明一个指向同样参数、返回值的函数指针类型</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">int</span> <span class="params">(*fun_ptr)</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>; </span><br><span class="line"><span class="comment">// 声明一个fun_ptr变量指向一个函数，这个函数有两个整型参数，返回值为整型</span></span><br></pre></td></tr></table></figure></p>
<p>回调函数<br>函数指针作为某个函数的参数.<br>函数指针变量可以作为某个函数的参数来使用的，回调函数就是一个通过函数指针调用的函数。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">populate_array</span><span class="params">(<span class="keyword">int</span> *<span class="built_in">array</span>, <span class="keyword">size_t</span> arraySize, <span class="keyword">int</span> (*getNextValue)(<span class="keyword">void</span>))</span> <span class="comment">//此处定义了个函数指针</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i&lt;arraySize; i++)</span><br><span class="line">        <span class="built_in">array</span>[i] = getNextValue();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 把函数指针定义拿出来，单独定义。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">int</span> <span class="params">(*getNextValue)</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">populate_array</span><span class="params">(<span class="keyword">int</span> *<span class="built_in">array</span>, <span class="keyword">size_t</span> arraySize,getNextValue)</span> <span class="comment">//使用函数指针</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i&lt;arraySize; i++)</span><br><span class="line">        <span class="built_in">array</span>[i] = getNextValue(); <span class="comment">//使用函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现面向对象的C<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*say)</span><span class="params">(<span class="keyword">char</span>*)</span></span>;</span><br><span class="line"><span class="comment">// 类</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">  <span class="keyword">char</span>* name,</span><br><span class="line">  <span class="keyword">int</span> age,</span><br><span class="line">  say,</span><br><span class="line">&#125; person;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现方法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sayimpl</span><span class="params">(<span class="keyword">char</span>* content)</span></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"say: %s"</span>,content);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象</span></span><br><span class="line">person p1=person&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法绑定</span></span><br><span class="line">p1.say = sayimpl;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法调用</span></span><br><span class="line">p1.say(<span class="string">"hello"</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="字符串处理"><a href="#字符串处理" class="headerlink" title="字符串处理"></a>字符串处理</h3><p>字符串实际上是使用 null 字符 ‘\0’ 终止的一维字符数组。<br>char greeting[6] = {‘H’, ‘e’, ‘l’, ‘l’, ‘o’, ‘\0’};<br>char greeting[] = “Hello”;</p>
<p>操作字符串的函数<br>strcpy(s1, s2);<br>strcat(s1, s2);<br>strlen(s1);<br>strcmp(s1, s2);<br>// index<br>strchr(s1, ch);<br>strstr(s1, s2);</p>
<h3 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h3><p>struct tag {<br>    member-list<br>    member-list<br>    member-list<br>    …<br>} variable-list ;</p>
<p>tag 是结构体标签<br>member-list 是标准的变量定义<br>variable-list 结构变量</p>
<p>访问结构成员：我们使用成员访问运算符（.）<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Books</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">char</span>  title[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  author[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  subject[<span class="number">100</span>];</span><br><span class="line">   <span class="keyword">int</span>   book_id;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Books</span> <span class="title">Book1</span>;</span>        <span class="comment">/* 声明 Book1，类型为 Books */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Books</span> <span class="title">Book2</span>;</span>        <span class="comment">/* 声明 Book2，类型为 Books */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 等价</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">char</span>  title[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  author[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  subject[<span class="number">100</span>];</span><br><span class="line">   <span class="keyword">int</span>   book_id;</span><br><span class="line">&#125;Book1,Book2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Book1 详述 */</span></span><br><span class="line"><span class="built_in">strcpy</span>( Book1.title, <span class="string">"C Programming"</span>);</span><br><span class="line"><span class="built_in">strcpy</span>( Book1.author, <span class="string">"Nuha Ali"</span>);</span><br><span class="line"><span class="built_in">strcpy</span>( Book1.subject, <span class="string">"C Programming Tutorial"</span>);</span><br><span class="line">Book1.book_id = <span class="number">6495407</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 输出 Book1 信息 */</span></span><br><span class="line"><span class="built_in">printf</span>( <span class="string">"Book 1 title : %s\n"</span>, Book1.title);</span><br><span class="line"><span class="built_in">printf</span>( <span class="string">"Book 1 author : %s\n"</span>, Book1.author);</span><br><span class="line"><span class="built_in">printf</span>( <span class="string">"Book 1 subject : %s\n"</span>, Book1.subject);</span><br><span class="line"><span class="built_in">printf</span>( <span class="string">"Book 1 book_id : %d\n"</span>, Book1.book_id);</span><br><span class="line"></span><br><span class="line"><span class="comment">//结构作为函数参数</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Books</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">char</span>  title[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  author[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  subject[<span class="number">100</span>];</span><br><span class="line">   <span class="keyword">int</span>   book_id;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 函数声明 */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printBook</span><span class="params">( struct Books book )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//指向结构的指针</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Books</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">char</span>  title[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  author[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  subject[<span class="number">100</span>];</span><br><span class="line">   <span class="keyword">int</span>   book_id;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 函数声明 */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printBook</span><span class="params">( struct Books *book )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 通过传 Book1 的地址来输出 Book1 信息 */</span></span><br><span class="line">printBook( &amp;Book1 );</span><br></pre></td></tr></table></figure></p>
<h3 id="位域"><a href="#位域" class="headerlink" title="位域"></a>位域</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">bs</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> a:<span class="number">8</span>;</span><br><span class="line">    <span class="keyword">int</span> b:<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> c:<span class="number">6</span>;</span><br><span class="line">&#125;data,*pdata;</span><br><span class="line"><span class="comment">// 说明 data 为 bs 变量，共占两个字节。其中位域 a 占 8 位，位域 b 占 2 位，位域 c 占 6 位。</span></span><br><span class="line"><span class="comment">// data.a 结构体变量访问结构体元素</span></span><br><span class="line"><span class="comment">// pdata-&gt;a 结构体指针访问结构体元素</span></span><br></pre></td></tr></table></figure>
<h3 id="共用体"><a href="#共用体" class="headerlink" title="共用体"></a>共用体</h3><p>共用体是一种特殊的数据类型，允许您在相同的内存位置存储不同的数据类型。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> Data</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">int</span> i;</span><br><span class="line">   <span class="keyword">float</span> f;</span><br><span class="line">   <span class="keyword">char</span>  str[<span class="number">20</span>];</span><br><span class="line">&#125; data;</span><br><span class="line"><span class="comment">// 现在，Data 类型的变量可以存储一个整数、一个浮点数，或者一个字符串。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 访问共用体成员</span></span><br><span class="line"><span class="comment">// 我们使用成员访问运算符（.）</span></span><br><span class="line"><span class="built_in">printf</span>( <span class="string">"data.str : %s\n"</span>, data.str);</span><br></pre></td></tr></table></figure></p>
<h3 id="typedef"><a href="#typedef" class="headerlink" title="typedef"></a>typedef</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> BYTE;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Books</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">char</span>  title[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  author[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  subject[<span class="number">100</span>];</span><br><span class="line">   <span class="keyword">int</span>   book_id;</span><br><span class="line">&#125; Book;</span><br><span class="line"></span><br><span class="line"><span class="comment">// typedef vs #define</span></span><br><span class="line"><span class="comment">// typedef 仅限于为类型定义符号名称，#define 不仅可以为类型定义别名，也能为数值定义别名，比如您可以定义 1 为 ONE。</span></span><br><span class="line"><span class="comment">// typedef 是由编译器执行解释的，#define 语句是由预编译器进行处理的。</span></span><br></pre></td></tr></table></figure>
<h3 id="输入-amp-输出"><a href="#输入-amp-输出" class="headerlink" title="输入 &amp; 输出"></a>输入 &amp; 输出</h3><p>getchar() &amp; putchar() 函数<br>  函数从屏幕读取下一个可用的字符，并把它返回为一个整数。</p>
<p>gets() &amp; puts() 函数<br>  函数从 stdin 读取一行到 s 所指向的缓冲区<br>  函数把字符串 s 和一个尾随的换行符写入到 stdout</p>
<p>scanf() 和 printf() 函数<br>  函数从标准输入流 stdin 读取输入</p>
<h3 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h3><p>FILE <em>fopen( const char </em> filename, const char <em> mode );<br>int fclose( FILE </em>fp );</p>
<p>int fputc( int c, FILE <em>fp );<br>int fputs( const char </em>s, FILE *fp );</p>
<p>int fgetc( FILE <em> fp );<br>char </em>fgets( char <em>buf, int n, FILE </em>fp );</p>
<p>二进制 I/O 函数<br>size_t fread(void <em>ptr, size_t size_of_elements, size_t number_of_elements, FILE </em>a_file);<br>size_t fwrite(const void <em>ptr, size_t size_of_elements, size_t number_of_elements, FILE </em>a_file);</p>
<h3 id="宏处理"><a href="#宏处理" class="headerlink" title="宏处理"></a>宏处理</h3><h1 id="define-定义宏"><a href="#define-定义宏" class="headerlink" title="define    定义宏"></a>define    定义宏</h1><h1 id="include-包含一个源代码文件"><a href="#include-包含一个源代码文件" class="headerlink" title="include    包含一个源代码文件"></a>include    包含一个源代码文件</h1><h1 id="undef-取消已定义的宏"><a href="#undef-取消已定义的宏" class="headerlink" title="undef    取消已定义的宏"></a>undef    取消已定义的宏</h1><h1 id="ifdef-如果宏已经定义，则返回真"><a href="#ifdef-如果宏已经定义，则返回真" class="headerlink" title="ifdef    如果宏已经定义，则返回真"></a>ifdef    如果宏已经定义，则返回真</h1><h1 id="ifndef-如果宏没有定义，则返回真"><a href="#ifndef-如果宏没有定义，则返回真" class="headerlink" title="ifndef    如果宏没有定义，则返回真"></a>ifndef    如果宏没有定义，则返回真</h1><h1 id="if-如果给定条件为真，则编译下面代码"><a href="#if-如果给定条件为真，则编译下面代码" class="headerlink" title="if    如果给定条件为真，则编译下面代码"></a>if    如果给定条件为真，则编译下面代码</h1><h1 id="else-if-的替代方案"><a href="#else-if-的替代方案" class="headerlink" title="else    #if 的替代方案"></a>else    #if 的替代方案</h1><h1 id="elif-如果前面的-if-给定条件不为真，当前条件为真，则编译下面代码"><a href="#elif-如果前面的-if-给定条件不为真，当前条件为真，则编译下面代码" class="headerlink" title="elif    如果前面的 #if 给定条件不为真，当前条件为真，则编译下面代码"></a>elif    如果前面的 #if 给定条件不为真，当前条件为真，则编译下面代码</h1><h1 id="endif-结束一个-if……-else-条件编译块"><a href="#endif-结束一个-if……-else-条件编译块" class="headerlink" title="endif    结束一个 #if……#else 条件编译块"></a>endif    结束一个 #if……#else 条件编译块</h1><h1 id="error-当遇到标准错误时，输出错误消息"><a href="#error-当遇到标准错误时，输出错误消息" class="headerlink" title="error    当遇到标准错误时，输出错误消息"></a>error    当遇到标准错误时，输出错误消息</h1><h1 id="pragma-使用标准化方法，向编译器发布特殊的命令到编译器中"><a href="#pragma-使用标准化方法，向编译器发布特殊的命令到编译器中" class="headerlink" title="pragma    使用标准化方法，向编译器发布特殊的命令到编译器中"></a>pragma    使用标准化方法，向编译器发布特殊的命令到编译器中</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_ARRAY_LENGTH 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 取消定义</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span>  FILE_SIZE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FILE_SIZE 42</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MESSAGE</span></span><br><span class="line">   <span class="meta">#<span class="meta-keyword">define</span> MESSAGE <span class="meta-string">"You wish!"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> DEBUG</span></span><br><span class="line">   <span class="comment">/* Your debugging statements here */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 预定义宏</span></span><br><span class="line">__DATE__	当前日期，一个以 <span class="string">"MMM DD YYYY"</span> 格式表示的字符常量。</span><br><span class="line">__TIME__	当前时间，一个以 <span class="string">"HH:MM:SS"</span> 格式表示的字符常量。</span><br><span class="line">__FILE__	这会包含当前文件名，一个字符串常量。</span><br><span class="line">__LINE__	这会包含当前行号，一个十进制常量。</span><br><span class="line">__STDC__	当编译器以 ANSI 标准编译时，则定义为 <span class="number">1</span>。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 预处理器运算符</span></span><br><span class="line"><span class="comment">// 宏延续运算符（\）</span></span><br><span class="line"><span class="comment">// 字符串常量化运算符（#）</span></span><br><span class="line"><span class="comment">// 当需要把一个宏的参数转换为字符串常量时，则使用字符串常量化运算符（#）。</span></span><br><span class="line"><span class="comment">// 定义</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  message_for(a, b)  \</span></span><br><span class="line">    <span class="built_in">printf</span>(#a <span class="string">" and "</span> #b <span class="string">": We love you!\n"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 替换</span></span><br><span class="line">message_for(Carole, Debra);</span><br><span class="line"><span class="comment">// 结果</span></span><br><span class="line">Carole <span class="keyword">and</span> Debra: We love you!</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标记粘贴运算符（##）</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> tokenpaster(n) printf (<span class="meta-string">"token"</span> #n <span class="meta-string">" = %d"</span>, token##n)</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line">tokenpaster(<span class="number">34</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果</span></span><br><span class="line"><span class="built_in">printf</span> (<span class="string">"token34 = %d"</span>, token34);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !defined (MESSAGE)</span></span><br><span class="line">   <span class="meta">#<span class="meta-keyword">define</span> MESSAGE <span class="meta-string">"You wish!"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数化的宏</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX(x,y) ((x) &gt; (y) ? (x) : (y))</span></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Max between 20 and 10 is %d\n"</span>, MAX(<span class="number">10</span>, <span class="number">20</span>));  </span><br><span class="line"><span class="comment">// 结果</span></span><br><span class="line">Max between <span class="number">20</span> <span class="keyword">and</span> <span class="number">10</span> is <span class="number">20</span></span><br><span class="line"><span class="comment">// 预处理完结果，其实本质是进行了替换</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Max between 20 and 10 is %d\n"</span>, ((<span class="number">10</span>) &gt; (<span class="number">20</span>) ? (<span class="number">10</span>) : (<span class="number">20</span>)));</span><br></pre></td></tr></table></figure>
<h3 id="头文件"><a href="#头文件" class="headerlink" title="头文件"></a>头文件</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在系统目录的标准列表中搜索名为 file 的文件</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;file&gt;</span></span></span><br><span class="line"><span class="comment">// 包含当前文件的目录中搜索名为 file 的文件</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"file"</span></span></span><br><span class="line"><span class="comment">// 只引用一次头文件</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> HEADER_FILE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEADER_FILE</span></span><br><span class="line"></span><br><span class="line">the entire header file file</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 有条件引用</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> SYSTEM_1</span></span><br><span class="line">   <span class="meta"># <span class="meta-keyword">include</span> <span class="meta-string">"system_1.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">elif</span> SYSTEM_2</span></span><br><span class="line">   <span class="meta"># <span class="meta-keyword">include</span> <span class="meta-string">"system_2.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">elif</span> SYSTEM_3</span></span><br><span class="line">   ...</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 宏名称代替</span></span><br><span class="line"> <span class="meta">#<span class="meta-keyword">define</span> SYSTEM_H <span class="meta-string">"system_1.h"</span></span></span><br><span class="line"> ...</span><br><span class="line"> <span class="meta">#<span class="meta-keyword">include</span> SYSTEM_H</span></span><br></pre></td></tr></table></figure>
<h3 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h3><p>(type_name) expression</p>
<p>整数提升</p>
<h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h3><p>errno.h<br>errno //错误号<br>perror() //函数显示您传给它的字符串<br>strerror() //返回一个指针，指针指向当前 errno 值的文本表示形式。<br>extern int errno ;<br>fprintf(stderr, “错误号: %d\n”, errno);<br>程序退出状态<br>EXIT_SUCCESS<br>EXIT_FAILURE</p>
<h3 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h3><p>递归用来处理规模越来越小的问题<br>递归三要素<br>  递归入口<br>  退出条件</p>
<h3 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h3><p>stdarg.h<br>// 定义<br>int func(int, … )<br>// 处理<br>va_list valist; // 定义一个参数列表<br>va_start(valist, num); // 对valist 赋值<br>va_arg(valist, int); // 处理列表元素<br>va_end(valist); // 清理 valist</p>
<h3 id="内存管理"><a href="#内存管理" class="headerlink" title="内存管理"></a>内存管理</h3><p>stdlib.h<br>void <em>calloc(int num, int size); //在内存中动态地分配 num 个长度为 size 的连续空间，并将每一个字节都初始化为 0。<br>void free(void </em>address); //释放 address 所指向的内存块,释放的是动态分配的内存空间。</p>
<p>void <em>malloc(int num); //在堆区分配一块指定大小的内存空间，用来存放数据。(不会被初始化)<br>void </em>realloc(void *address, int newsize); // 该函数重新分配内存，把内存扩展到 newsize。</p>
<p>/<em> 动态分配内存 </em>/<br>description = (char <em>)malloc( 200 </em> sizeof(char) );</p>
<p>// 扩展动态分配<br>description = (char <em>)malloc( 30 </em> sizeof(char) );<br>description = (char <em>) realloc( description, 100 </em> sizeof(char) );<br>free(description);</p>
<h3 id="命令行参数"><a href="#命令行参数" class="headerlink" title="命令行参数"></a>命令行参数</h3><p>int main( int argc, char *argv[] )</p>
<h3 id="排序算法"><a href="#排序算法" class="headerlink" title="排序算法"></a>排序算法</h3><p>冒泡排序<br>选择排序<br>插入排序<br>希尔排序<br>归并排序<br>快速排序</p>
<ul>
<li><a href="https://www.runoob.com/cprogramming/c-examples.html" target="_blank" rel="noopener">C 语言实例</a></li>
<li><a href="https://www.runoob.com/cprogramming/c-100-examples.html" target="_blank" rel="noopener">C 语言经典100例</a></li>
</ul>
<h3 id="C-标准库介绍"><a href="#C-标准库介绍" class="headerlink" title="C 标准库介绍"></a>C 标准库介绍</h3><div class="table-container">
<table>
<thead>
<tr>
<th>头文件</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>assert.h</td>
<td></td>
</tr>
<tr>
<td>ctype.h</td>
<td>字符处理</td>
</tr>
<tr>
<td>errno.h</td>
<td>错误处理</td>
</tr>
<tr>
<td>float.h</td>
<td>浮点数处理</td>
</tr>
<tr>
<td>limits.h</td>
<td>宏限制了各种变量类型（比如 char、int 和 long）的值。</td>
</tr>
<tr>
<td>locale.h</td>
<td>日期格式和货币符号</td>
</tr>
<tr>
<td>math.h</td>
<td>各种数学函数</td>
</tr>
<tr>
<td>setjmp.h</td>
<td>环境变量</td>
</tr>
<tr>
<td>signal.h</td>
<td>信号处理</td>
</tr>
<tr>
<td>stdarg.h</td>
<td>可变函数处理</td>
</tr>
<tr>
<td>stddef.h</td>
<td>宏定义</td>
</tr>
<tr>
<td>stdio.h</td>
<td>输入输出</td>
</tr>
<tr>
<td>stdlib.h</td>
<td>工具函数</td>
</tr>
<tr>
<td>string.h</td>
<td>字符串处理</td>
</tr>
<tr>
<td>time.h</td>
<td>时间处理函数</td>
</tr>
</tbody>
</table>
</div>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.yanqi.cf/2020/06/%E5%B9%B3%E5%8F%B0%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yan qi">
      <meta itemprop="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blyanqi@163.com">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/%E5%B9%B3%E5%8F%B0%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">平台分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-18 10:55:23" itemprop="dateCreated datePublished" datetime="2020-06-18T10:55:23+08:00">2020-06-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-07-11 11:35:05" itemprop="dateModified" datetime="2020-07-11T11:35:05+08:00">2020-07-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BF%90%E7%BB%B4/" itemprop="url" rel="index"><span itemprop="name">运维</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>367</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>OTA -&gt;cid -&gt;平台 -&gt;ipcc</p>
<p>白名单<br>  -&gt; bmd数据库表<br>  加载白名单的cid<br>  售卖的时间段（依照出发日期配置）<br>  每秒最大并发数<br>  配置文件路径<br>  超时时间<br>    连接超时<br>    读取超时<br>  日志处理</p>
<p>查询<br>  熔断时间<br>  engine的url配置<br>  航段费缓存<br>  航线过滤<br>  数据压缩<br>  机型过滤<br>  儿童价转换成人价<br>  生单失败缓存<br>  额外调价缓存<br>  匹配政策地址<br>  特殊运价缓存<br>  退改费用设置</p>
<p>engine<br>  缓存配置<br>  压缩配置<br>  黑名单拦截<br>  预跑配置<br>  流控处理<br>  数据异常拦截</p>
<p>policy<br>  缓存配置<br>  汇率刷新</p>
<p>订单<br>  密钥串<br>  加减价配置<br>  航段费配置<br>  手续费配置<br>  渠道标识<br>  价格校验重查<br>  ipcc配置<br>  政策服务配置<br>  生单跳价阈值<br>  儿童转成人<br>  中转配置<br>  价格校验生单失败清楚有效缓存<br>  渠道cid配置<br>  生单失败处理<br>  行李额处理<br>  wex 卡请求地址<br>  报警地址配置</p>
<p>配置中心<br>权限管理</p>
<p>运营调控<br>政策管理<br>供应商管理<br>汇率管理<br>订单管理<br>清Q系统<br>供应商出票系统<br>官网数据爬取管理</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.yanqi.cf/2020/06/Metricbeats/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yan qi">
      <meta itemprop="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blyanqi@163.com">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/Metricbeats/" class="post-title-link" itemprop="url">metricbeats</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-17 10:58:54" itemprop="dateCreated datePublished" datetime="2020-06-17T10:58:54+08:00">2020-06-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-07-11 11:03:54" itemprop="dateModified" datetime="2020-07-11T11:03:54+08:00">2020-07-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/BIGDATA/" itemprop="url" rel="index"><span itemprop="name">BIGDATA</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>292</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>metribeats:<br><a href="https://artifacts.elastic.co/downloads/beats/metricbeat/metricbeat-6.6.0-linux-x86_64.tar.gz" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/beats/metricbeat/metricbeat-6.6.0-linux-x86_64.tar.gz</a></p>
<p>vim metricbeat.yml<br>output.elasticsearch:<br>  hosts: [“<es_url>“]<br>  username: “elastic”<br>  password: “<password>“<br>setup.kibana:<br>  host: “<kibana_url>“</kibana_url></password></es_url></p>
<p>./metricbeat modules enable system<br>./metricbeat setup<br>./metricbeat -e</p>
<p>./metricbeat -e -c metricbeat.yml</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.yanqi.cf/2020/06/Elasticsearch/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yan qi">
      <meta itemprop="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blyanqi@163.com">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/Elasticsearch/" class="post-title-link" itemprop="url">Elasticsearch</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-17 10:49:52" itemprop="dateCreated datePublished" datetime="2020-06-17T10:49:52+08:00">2020-06-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-07-11 11:03:10" itemprop="dateModified" datetime="2020-07-11T11:03:10+08:00">2020-07-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/BIGDATA/" itemprop="url" rel="index"><span itemprop="name">BIGDATA</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>elasticsearch<br>ES概念<br>cluster：<br>集群中有多个节点，其中有一个为主节点，这个主节点是可以通过选举产生的，主从节点是对于集群内部来说的。es的一个概念就是去中心化，字面上理解就是无中心节点。<br>在逻辑上是个整体，你与任何一个节点的通信和与整个es集群通信是等价的。</p>
<p>shards：<br>分片的数量只能在索引创建前指定，并且索引创建后不能更改。<br>分片索引</p>
<p>replicas：<br>代表索引副本，es可以设置多个索引的副本，副本的作用一是提高系统的容错性，当某个节点某个分片损坏或丢失时可以从副本中恢复。二是提高es的查询效率，es会自动对搜索请求进行负载均衡。</p>
<p>gateway：<br>索引保存，当这个es集群关闭再重新启动时就会从gateway中读取索引备份数据。</p>
<p>discovery.zen：<br>节点自动发现，多播，广播方式。它先通过广播寻找存在的节点，再通过多播协议来进行节点之间的通信，同时也支持点对点的交互。</p>
<p>recovery：<br>数据源，通过读取river中的数据并把它索引到es中，官方的river有couchDB的，RabbitMQ的，Twitter的，Wikipedia的。</p>
<p>Transport：<br>代表es内部节点或集群与客户端的交互方式，默认内部是使用tcp协议进行交互，同时它支持http协议（json格式）、thrift、servlet、memcached、zeroMQ等的传输协议（通过插件方式集成）。</p>
<p>基本概念<br>2.1 Node 与 Cluster<br>Elastic 本质上是一个分布式数据库，允许多台服务器协同工作，每台服务器可以运行多个 Elastic 实例。<br>单个 Elastic 实例称为一个节点（node）。一组节点构成一个集群（cluster）。</p>
<p>2.2 Index<br>Elastic 会索引所有字段，经过处理后写入一个反向索引（Inverted Index）。查找数据的时候，直接查找该索引。</p>
<p>所以，Elastic 数据管理的顶层单位就叫做 Index（索引）。它是单个数据库的同义词。每个 Index （即数据库）的名字必须是小写。</p>
<p>下面的命令可以查看当前节点的所有 Index。<br>$ curl -X GET ‘<a href="http://localhost:9200/_cat/indices?v" target="_blank" rel="noopener">http://localhost:9200/_cat/indices?v</a>‘</p>
<p>2.3 Document<br>Index 里面单条的记录称为 Document（文档）。许多条 Document 构成了一个 Index。</p>
<p>Document 使用 JSON 格式表示，下面是一个例子。<br>{<br>  “user”: “张三”,<br>  “title”: “工程师”,<br>  “desc”: “数据库管理”<br>}<br>同一个 Index 里面的 Document，不要求有相同的结构（scheme），但是最好保持相同，这样有利于提高搜索效率。</p>
<p>2.4 Type<br>Document 可以分组，比如weather这个 Index 里面，可以按城市分组（北京和上海），也可以按气候分组（晴天和雨天）。这种分组就叫做 Type，它是虚拟的逻辑分组，用来过滤 Document。</p>
<p>不同的 Type 应该有相似的结构（schema），举例来说，id字段不能在这个组是字符串，在另一个组是数值。这是与关系型数据库的表的一个区别。性质完全不同的数据（比如products和logs）应该存成两个 Index，而不是一个 Index 里面的两个 Type（虽然可以做到）。</p>
<p>下面的命令可以列出每个 Index 所包含的 Type。</p>
<p>$ curl ‘localhost:9200/_mapping?pretty=true’<br>根据规划，Elastic 6.x 版只允许每个 Index 包含一个 Type，7.x 版将会彻底移除 Type。</p>
<p>elasticsearch</p>
<p>Node 多节点<br>Cluster 集群<br>Document 文档<br>Index 索引<br>Type 类型<br>Field 字段<br>Shards 分片<br>Replicas  复制集</p>
<p>非结构化的数据</p>
<p>结构化数据</p>
<p>elasticsearch 架构</p>
<p>广播方式寻找节点<br>http 传输</p>
<p>插件<br>中文分词<br>状态监控<br>Solr 知识搜索<br>Elasticsearch 只支持json</p>
<p>XML(SOAP),占带宽，解析慢<br>JSON，短小精悍，解析快</p>
<p>表现层状态转化<br>资源—URI<br>API操作<br>GET：获取<br>POST：新建<br>PUT:更新<br>DELETE：删除</p>
<p>curl -i<br>curl -v<br>curl -o output<br>curl -X POST<br>curl —trace</p>
<p>单模式<br>多模式</p>
<p>安装<br>系统准备<br>JDK—&gt; Elasticsearch 对应关系<br>./elasticsearch -d</p>
<p>插件<br>Head web 管理 elasticsearch<br>Bigdesk 集群监控工具<br>Mavel 插件<br>plugin-install elasticsearch/marvel/latest<br><a href="http://locathost:9200/_plugin/marvel" target="_blank" rel="noopener">http://locathost:9200/_plugin/marvel</a></p>
<p>分词插件</p>
<p>同步插件</p>
<p>倒排索引<br>关键词-》文档 （文档id，位置，频次）</p>
<p>创建索引<br>名称 分片数 副本</p>
<p>创建文档</p>
<p>获取文档</p>
<p>获取指定字段<br>/1?_source=title</p>
<p>更新<br>/1/_update</p>
<p>删除</p>
<p>内置字段以及类型<br>_uid<br>_id<br>_type<br>_source<br>_all<br>_analyzer<br>_boost<br>_parent<br>_routing<br>_index<br>_size<br>_timestamp<br>_ttl</p>
<p>字段类型<br>String<br>Integer/long<br>Float/double<br>Boolean<br>Null<br>Date</p>
<p>多模式<br>获取<br>_mget</p>
<p>获取指定字段</p>
<p>批量操作bulk（\n分隔符）<br>CIUD<br>_bulk<br>metadata<br>body</p>
<p>ram设置对bulk处理有性能影响</p>
<p>版本控制<br>悲观锁，乐观锁<br>内部版本控制  _version<br>外部版本控制  version=5&amp;version_type=external</p>
<p>Mapping 映射<br>一旦建立映射，就不能修改现有映射（修改方法，现有映射建立别名，再创建一个新映射，将别名指向映射）<br>静态映射<br>动态映射<br>没见过的字段时，动态映射可以决定该字段类型</p>
<p>store 是否存储<br>index 是否索引<br>null_value 设置空值<br>boost 设置字段权重<br>index_analyer 索引时用分析器<br>search_analyzer 搜索时用的分析器<br>analyzer 索引搜索时使用分析器<br>include_in_all 排除某个字段<br>index_name 字段名称<br>norms 计算权值</p>
<p>“settings”:{},<br>“mappings”:{}<br>_all/_mapping</p>
<p>查询<br>基本查询<br>/_search?q=title:keyword<br>可以跨索引名搜索<br>_score: 打分<br>“terms”{<br>“preview”:[“”,””],<br>“minimum_match”:1 #1 or #2 and<br>}<br>“from”:10 #从第几行<br>“size”: 20 #返回条数</p>
<p>“slop”:2 #间隔单词<br>“fields”:<br>支持通配符<br>“sort”:[]<br>“prefix”:<br>“range”:<br>“wildcard”:<br>“fuzzy”: #模糊查询-可以相识查询<br>“fuzzy_like_this”:<br>“fuzzy_like_this_field”:<br>“more_like_this”:<br>“more_like_this_field”:<br>“match_all”: #查询所有</p>
<p>过滤<br>filter （相当于where）</p>
<p>“bool”: # and or<br>must<br>should<br>must_not</p>
<p>嵌套查询<br>“or”:[]<br>“not”:[]</p>
<p>gt<br>lt<br>gte<br>lte</p>
<p>过滤空和非空<br>exists<br>missing</p>
<p>cache 缓存<br>segment<br>bigset<br>“_cache”:true</p>
<p>组合查询<br>bool<br>coordination #关键词计分<br>boosting<br>positive<br>negative<br>negative_boost</p>
<p>constant_score</p>
<p>indices #多索引查询</p>
<p>logstash<br>插件<br>导入yum 源<br>yum install logstash<br>日志格式<br>时间 主机名 message<br>配置<br>处理输入input<br>处理filter<br>处理output</p>
<p>区域<br>数据类型<br>布尔<br>字节<br>字符串<br>数值<br>数组<br>哈希<br>编码解码<br>密码型<br>路径<br>注释</p>
<h1 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h1><p>字段引用<br>%{[][]}</p>
<p>插件<br>inputs<br>codecs<br>filters<br>outputs<br>Gemfile #记录插件<br>plugin install pluginname</p>
<p>gem source -l<br><a href="https://ruby.taobao.org" target="_blank" rel="noopener">https://ruby.taobao.org</a></p>
<p>kibana</p>
<p>集群 &gt; 节点 &gt; 类型 &gt; 文档 &gt; 属性<br>cluster &gt; node &gt; type &gt; documents &gt; attibute</p>
<p>index &gt; documents<br>       type<br>index :表<br>documents ：纪录<br>type ：按维度分类</p>
<p>shards : 分片<br>replicas : 副本<br>一个 index 可以有 3个分片（跟node 节点相同） 2个副本集。这样任一节点失败都不会导致数据丢失。</p>
<p>mapping ：映射，是指把documents field 映射成 对应的类型<br>gateway : 路由，控制数据存储的分片<br>_id: routeid </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.yanqi.cf/2020/06/Elasticsearch%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yan qi">
      <meta itemprop="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blyanqi@163.com">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/Elasticsearch%E7%AE%A1%E7%90%86/" class="post-title-link" itemprop="url">Elasticsearch管理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-17 10:48:47" itemprop="dateCreated datePublished" datetime="2020-06-17T10:48:47+08:00">2020-06-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-07-11 11:03:25" itemprop="dateModified" datetime="2020-07-11T11:03:25+08:00">2020-07-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/BIGDATA/" itemprop="url" rel="index"><span itemprop="name">BIGDATA</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>7.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Elasticsearch使用<br><a href="http://www.ruanyifeng.com/blog/2017/08/elasticsearch.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2017/08/elasticsearch.html</a><br><a href="https://es.xiaoleilu.com/" target="_blank" rel="noopener">https://es.xiaoleilu.com/</a></p>
<p>三、新建和删除 Index<br>新建 Index，可以直接向 Elastic 服务器发出 PUT 请求。下面的例子是新建一个名叫weather的 Index。</p>
<p>$ curl -X PUT ‘localhost:9200/weather’<br>服务器返回一个 JSON 对象，里面的acknowledged字段表示操作成功。</p>
<p>{<br>  “acknowledged”:true,<br>  “shards_acknowledged”:true<br>}<br>然后，我们发出 DELETE 请求，删除这个 Index。</p>
<p>$ curl -X DELETE ‘localhost:9200/weather’<br>四、中文分词设置<br>首先，安装中文分词插件。这里使用的是 ik，也可以考虑其他插件（比如 smartcn）。</p>
<p>$ ./bin/elasticsearch-plugin install <a href="https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v5.5.1/elasticsearch-analysis-ik-5.5.1.zip" target="_blank" rel="noopener">https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v5.5.1/elasticsearch-analysis-ik-5.5.1.zip</a><br>上面代码安装的是5.5.1版的插件，与 Elastic 5.5.1 配合使用。</p>
<p>接着，重新启动 Elastic，就会自动加载这个新安装的插件。</p>
<p>然后，新建一个 Index，指定需要分词的字段。这一步根据数据结构而异，下面的命令只针对本文。基本上，凡是需要搜索的中文字段，都要单独设置一下。</p>
<p>$ curl -X PUT ‘localhost:9200/accounts’ -d ‘<br>{<br>  “mappings”: {<br>    “person”: {<br>      “properties”: {<br>        “user”: {<br>          “type”: “text”,<br>          “analyzer”: “ik_max_word”,<br>          “search_analyzer”: “ik_max_word”<br>        },<br>        “title”: {<br>          “type”: “text”,<br>          “analyzer”: “ik_max_word”,<br>          “search_analyzer”: “ik_max_word”<br>        },<br>        “desc”: {<br>          “type”: “text”,<br>          “analyzer”: “ik_max_word”,<br>          “search_analyzer”: “ik_max_word”<br>        }<br>      }<br>    }<br>  }<br>}’<br>上面代码中，首先新建一个名称为accounts的 Index，里面有一个名称为person的 Type。person有三个字段。</p>
<p>user<br>title<br>desc<br>这三个字段都是中文，而且类型都是文本（text），所以需要指定中文分词器，不能使用默认的英文分词器。</p>
<p>Elastic 的分词器称为 analyzer。我们对每个字段指定分词器。</p>
<p>“user”: {<br>  “type”: “text”,<br>  “analyzer”: “ik_max_word”,<br>  “search_analyzer”: “ik_max_word”<br>}<br>上面代码中，analyzer是字段文本的分词器，search_analyzer是搜索词的分词器。ik_max_word分词器是插件ik提供的，可以对文本进行最大数量的分词。</p>
<p>五、数据操作<br>5.1 新增记录<br>向指定的 /Index/Type 发送 PUT 请求，就可以在 Index 里面新增一条记录。比如，向/accounts/person发送请求，就可以新增一条人员记录。</p>
<p>$ curl -X PUT ‘localhost:9200/accounts/person/1’ -d ‘<br>{<br>  “user”: “张三”,<br>  “title”: “工程师”,<br>  “desc”: “数据库管理”<br>}’<br>服务器返回的 JSON 对象，会给出 Index、Type、Id、Version 等信息。</p>
<p>{<br>  “_index”:”accounts”,<br>  “_type”:”person”,<br>  “_id”:”1”,<br>  “_version”:1,<br>  “result”:”created”,<br>  “_shards”:{“total”:2,”successful”:1,”failed”:0},<br>  “created”:true<br>}<br>如果你仔细看，会发现请求路径是/accounts/person/1，最后的1是该条记录的 Id。它不一定是数字，任意字符串（比如abc）都可以。</p>
<p>新增记录的时候，也可以不指定 Id，这时要改成 POST 请求。</p>
<p>$ curl -X POST ‘localhost:9200/accounts/person’ -d ‘<br>{<br>  “user”: “李四”,<br>  “title”: “工程师”,<br>  “desc”: “系统管理”<br>}’<br>上面代码中，向/accounts/person发出一个 POST 请求，添加一个记录。这时，服务器返回的 JSON 对象里面，_id字段就是一个随机字符串。</p>
<p>{<br>  “_index”:”accounts”,<br>  “_type”:”person”,<br>  “_id”:”AV3qGfrC6jMbsbXb6k1p”,<br>  “_version”:1,<br>  “result”:”created”,<br>  “_shards”:{“total”:2,”successful”:1,”failed”:0},<br>  “created”:true<br>}<br>注意，如果没有先创建 Index（这个例子是accounts），直接执行上面的命令，Elastic 也不会报错，而是直接生成指定的 Index。所以，打字的时候要小心，不要写错 Index 的名称。</p>
<p>5.2 查看记录<br>向/Index/Type/Id发出 GET 请求，就可以查看这条记录。</p>
<p>$ curl ‘localhost:9200/accounts/person/1?pretty=true’<br>上面代码请求查看/accounts/person/1这条记录，URL 的参数pretty=true表示以易读的格式返回。</p>
<p>返回的数据中，found字段表示查询成功，_source字段返回原始记录。</p>
<p>{<br>  “_index” : “accounts”,<br>  “_type” : “person”,<br>  “_id” : “1”,<br>  “_version” : 1,<br>  “found” : true,<br>  “_source” : {<br>    “user” : “张三”,<br>    “title” : “工程师”,<br>    “desc” : “数据库管理”<br>  }<br>}<br>如果 Id 不正确，就查不到数据，found字段就是false。</p>
<p>$ curl ‘localhost:9200/weather/beijing/abc?pretty=true’</p>
<p>{<br>  “_index” : “accounts”,<br>  “_type” : “person”,<br>  “_id” : “abc”,<br>  “found” : false<br>}<br>5.3 删除记录<br>删除记录就是发出 DELETE 请求。</p>
<p>$ curl -X DELETE ‘localhost:9200/accounts/person/1’<br>这里先不要删除这条记录，后面还要用到。</p>
<p>5.4 更新记录<br>更新记录就是使用 PUT 请求，重新发送一次数据。</p>
<p>$ curl -X PUT ‘localhost:9200/accounts/person/1’ -d ‘<br>{<br>    “user” : “张三”,<br>    “title” : “工程师”,<br>    “desc” : “数据库管理，软件开发”<br>}’ </p>
<p>{<br>  “_index”:”accounts”,<br>  “_type”:”person”,<br>  “_id”:”1”,<br>  “_version”:2,<br>  “result”:”updated”,<br>  “_shards”:{“total”:2,”successful”:1,”failed”:0},<br>  “created”:false<br>}<br>上面代码中，我们将原始数据从”数据库管理”改成”数据库管理，软件开发”。 返回结果里面，有几个字段发生了变化。</p>
<p>“_version” : 2,<br>“result” : “updated”,<br>“created” : false<br>可以看到，记录的 Id 没变，但是版本（version）从1变成2，操作类型（result）从created变成updated，created字段变成false，因为这次不是新建记录。</p>
<p>六、数据查询<br>6.1 返回所有记录<br>使用 GET 方法，直接请求/Index/Type/_search，就会返回所有记录。</p>
<p>$ curl ‘localhost:9200/accounts/person/_search’</p>
<p>{<br>  “took”:2,<br>  “timed_out”:false,<br>  “_shards”:{“total”:5,”successful”:5,”failed”:0},<br>  “hits”:{<br>    “total”:2,<br>    “max_score”:1.0,<br>    “hits”:[<br>      {<br>        “_index”:”accounts”,<br>        “_type”:”person”,<br>        “_id”:”AV3qGfrC6jMbsbXb6k1p”,<br>        “_score”:1.0,<br>        “_source”: {<br>          “user”: “李四”,<br>          “title”: “工程师”,<br>          “desc”: “系统管理”<br>        }<br>      },<br>      {<br>        “_index”:”accounts”,<br>        “_type”:”person”,<br>        “_id”:”1”,<br>        “_score”:1.0,<br>        “_source”: {<br>          “user” : “张三”,<br>          “title” : “工程师”,<br>          “desc” : “数据库管理，软件开发”<br>        }<br>      }<br>    ]<br>  }<br>}<br>上面代码中，返回结果的 took字段表示该操作的耗时（单位为毫秒），timed_out字段表示是否超时，hits字段表示命中的记录，里面子字段的含义如下。</p>
<p>total：返回记录数，本例是2条。<br>max_score：最高的匹配程度，本例是1.0。<br>hits：返回的记录组成的数组。<br>返回的记录中，每条记录都有一个_score字段，表示匹配的程序，默认是按照这个字段降序排列。</p>
<p>6.2 全文搜索<br>Elastic 的查询非常特别，使用自己的查询语法，要求 GET 请求带有数据体。</p>
<p>$ curl ‘localhost:9200/accounts/person/_search’  -d ‘<br>{<br>  “query” : { “match” : { “desc” : “软件” }}<br>}’<br>上面代码使用 Match 查询，指定的匹配条件是desc字段里面包含”软件”这个词。返回结果如下。</p>
<p>{<br>  “took”:3,<br>  “timed_out”:false,<br>  “_shards”:{“total”:5,”successful”:5,”failed”:0},<br>  “hits”:{<br>    “total”:1,<br>    “max_score”:0.28582606,<br>    “hits”:[<br>      {<br>        “_index”:”accounts”,<br>        “_type”:”person”,<br>        “_id”:”1”,<br>        “_score”:0.28582606,<br>        “_source”: {<br>          “user” : “张三”,<br>          “title” : “工程师”,<br>          “desc” : “数据库管理，软件开发”<br>        }<br>      }<br>    ]<br>  }<br>}<br>Elastic 默认一次返回10条结果，可以通过size字段改变这个设置。</p>
<p>$ curl ‘localhost:9200/accounts/person/_search’  -d ‘<br>{<br>  “query” : { “match” : { “desc” : “管理” }},<br>  “size”: 1<br>}’<br>上面代码指定，每次只返回一条结果。</p>
<p>还可以通过from字段，指定位移。</p>
<p>$ curl ‘localhost:9200/accounts/person/_search’  -d ‘<br>{<br>  “query” : { “match” : { “desc” : “管理” }},<br>  “from”: 1,<br>  “size”: 1<br>}’<br>上面代码指定，从位置1开始（默认是从位置0开始），只返回一条结果。</p>
<p>6.3 逻辑运算<br>如果有多个搜索关键字， Elastic 认为它们是or关系。</p>
<p>$ curl ‘localhost:9200/accounts/person/_search’  -d ‘<br>{<br>  “query” : { “match” : { “desc” : “软件 系统” }}<br>}’<br>上面代码搜索的是软件 or 系统。</p>
<p>如果要执行多个关键词的and搜索，必须使用布尔查询。</p>
<p>$ curl ‘localhost:9200/accounts/person/_search’  -d ‘<br>{<br>  “query”: {<br>    “bool”: {<br>      “must”: [<br>        { “match”: { “desc”: “软件” } },<br>        { “match”: { “desc”: “系统” } }<br>      ]<br>    }<br>  }<br>}’</p>
<h2 id="一旦在存储超过95％的磁盘中的节点上分配了一个或多个分片的任何索引，该索引将被强制进入只读模式"><a href="#一旦在存储超过95％的磁盘中的节点上分配了一个或多个分片的任何索引，该索引将被强制进入只读模式" class="headerlink" title="一旦在存储超过95％的磁盘中的节点上分配了一个或多个分片的任何索引，该索引将被强制进入只读模式"></a>一旦在存储超过95％的磁盘中的节点上分配了一个或多个分片的任何索引，该索引将被强制进入只读模式</h2><p>PUT _settings<br>    {<br>    “index”: {<br>    “blocks”: {<br>    “read_only_allow_delete”: “false”<br>    }<br>    }<br>    }</p>
<p>curl -XPUT -H “Content-Type: application/json” <a href="http://localhost:9200/_all/_settings" target="_blank" rel="noopener">http://localhost:9200/_all/_settings</a> -d ‘{“index.blocks.read_only_allow_delete”: null}’</p>
<p>建立索引</p>
<p>PUT twitter/_doc/1<br>{<br>    “user” : “kimchy”,<br>    “post_date” : “2009-11-15T14:12:12”,<br>    “message” : “trying out Elasticsearch”<br>}</p>
<p>curl -XPUT 127.0.0.1:9200/lcc_redis_xx -d “”</p>
<h1 id="获取redis-数据"><a href="#获取redis-数据" class="headerlink" title="获取redis 数据"></a>获取redis 数据</h1><p>redis</p>
<p>lcc<em>redis_bx  count(min)<br>lcc_redis</em>*</p>
<p>100G</p>
<p>1、创建索引：curl -XPUT <a href="http://localhost:9200/test1/es/1" target="_blank" rel="noopener">http://localhost:9200/test1/es/1</a> -d “{\”first_name\”:\”test1\”}”<br>通过文件导入：curl -XPOST 127.0.0.1:9200/bank/account/_bulk?pretty —data-binary @accounts.json</p>
<p>curl -H ‘Content-Type: application/json’ -XPUT 119.84.8.44:60116/lcc_redis_lcfr_f/_doc/1 -d “{}”</p>
<p>2、查询索引：curl -XPOST 127.0.0.1:9200/aaa/_search?pretty -d “{\”query\”: { \”match_all\”: {} }}”<br>　　　　　　curl -XGET 127.0.0.1:9200/aaa/_search?pretty -d “{\”query\”: { \”match_all\”: {} }}”<br>　　　　　　curl -XGET 127.0.0.1:9200/aaa/bbb/222<br>3、修改索引：curl -XPUT “<a href="http://localhost:9200/fendo/account/222" target="_blank" rel="noopener">http://localhost:9200/fendo/account/222</a>“ -d “{\”first_name\”:\”fk\”}<br>4、删除索引：curl -XDELETE <a href="http://127.0.0.1:9200/fendo/account/222" target="_blank" rel="noopener">http://127.0.0.1:9200/fendo/account/222</a><br>5、查看所有索引：curl localhost:9200/_cat/indices?v</p>
<p>curl -H “Content-Type: application/json” -XPOST 192.168.14.173:32000/test_index_1221/test_type/5 -d ‘{‘user_name’:”xiaoming”}’</p>
<p>分片管理</p>
<p>GET _ilm/policy/engine-result</p>
<p>PUT _ilm/policy/engine-result<br>{<br>  “policy”: {<br>    “phases”: {<br>      “hot”: {<br>        “actions”: {<br>          “rollover”: {<br>            “max_age”: “14d”,<br>            “max_size”: “90G”<br>          },<br>          “set_priority”: {<br>            “priority”: 100<br>          }<br>        }<br>      },<br>      “warm”: {<br>        “min_age”: “14d”,<br>        “actions”: {<br>          “forcemerge”: {<br>            “max_num_segments”: 1<br>          },<br>          “allocate”: {<br>            “number_of_replicas”: 0<br>          },<br>          “set_priority”: {<br>            “priority”: 50<br>          }<br>        }<br>      },<br>      “cold”: {<br>        “min_age”: “30d”,<br>        “actions”: {<br>          “freeze”: {}<br>        }<br>      },<br>      “delete”: {<br>        “min_age”: “210d”,<br>        “actions”: {<br>          “delete”: {}<br>        }<br>      }<br>    }<br>  }<br>}</p>
<p>POST /engine-result/_flush</p>
<h1 id="bin-bash"><a href="#bin-bash" class="headerlink" title="!/bin/bash"></a>!/bin/bash</h1><p>time=$(date -d ‘-3days’ +’%Y.%m.%d’)<br>curl -XDELETE -u elastic:56781234 <a href="http://localhost:9200/engine-result-${time}*" target="_blank" rel="noopener">http://localhost:9200/engine-result-${time}*</a><br>curl -XDELETE -u elastic:56781234 <a href="http://localhost:9200/ota-query-${time}*" target="_blank" rel="noopener">http://localhost:9200/ota-query-${time}*</a></p>
<p>GET /_cat/indices/?v</p>
<p>GET .kibana/_search<br>{<br>  “_source”: [“index-pattern.title”],<br>  “query”: {<br>    “term”: {<br>      “type”: “index-pattern”<br>    }<br>  }<br>}</p>
<p>POST /engine-result-2019.09.09-000001/_close</p>
<p>DELETE /engine-result-2019.09.09-000001</p>
<p>POST /engine-result/_flush</p>
<p>GET /engine-result/_mapping?pretty</p>
<p>GET _ilm/policy/engine-result</p>
<p>PUT _ilm/policy/engine-result<br>{<br>  “policy” : {<br>      “phases” : {<br>        “hot” : {<br>          “min_age” : “0ms”,<br>          “actions” : {<br>            “rollover” : {<br>              “max_size” : “10gb”,<br>              “max_age” : “1d”<br>            },<br>            “set_priority” : {<br>              “priority” : 100<br>            }<br>          }<br>        },<br>        “cold”: {<br>        “min_age”: “1d”,<br>        “actions”: {<br>          “freeze”: {}<br>        }<br>        },<br>        “delete”: {<br>        “min_age”: “1d”,<br>        “actions”: {<br>          “delete”: {}<br>        }<br>      }<br>      }<br>    }<br>}</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.yanqi.cf/2020/06/Elasticsearch%E5%AE%89%E8%A3%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yan qi">
      <meta itemprop="description" content="君子学以聚之，问以辩之，宽以居之，仁以行之。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blyanqi@163.com">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/Elasticsearch%E5%AE%89%E8%A3%85/" class="post-title-link" itemprop="url">elasticsearch安装</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-17 10:46:40" itemprop="dateCreated datePublished" datetime="2020-06-17T10:46:40+08:00">2020-06-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-07-11 11:03:16" itemprop="dateModified" datetime="2020-07-11T11:03:16+08:00">2020-07-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/BIGDATA/" itemprop="url" rel="index"><span itemprop="name">BIGDATA</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>base configuration<br>easticsearch<br>logstash<br>filebeat</p>
<p>base configuration<br>/etc/hosts<br>192.168.0.130 elastic1<br>192.168.0.131 elastic2<br>192.168.0.132 elastic3</p>
<p>ssh-keygen -t rsa<br>ssh-copy-id 192.168.0.130<br>ssh-copy-id 192.168.0.131<br>ssh-copy-id 192.168.0.133</p>
<p>192.168.0.130 master<br>192.168.0.131 node1<br>192.168.0.132 node2</p>
<p>yum -y install rsync&amp;&amp;/usr/bin/rsync -avzuP —delete —port=873 monitor@106.15.137.193::autosh /opt/autosh/</p>
<p>设置资源限制<br>echo “* soft nofile 65536</p>
<ul>
<li>hard nofile 65536</li>
<li>soft nproc 32000</li>
<li>hard nproc 32000</li>
<li>hard memlock unlimited</li>
<li>soft memlock unlimited”&gt;&gt;/etc/security/limits.conf</li>
</ul>
<p>echo “DefaultLimitNOFILE=65536<br>DefaultLimitNPROC=32000<br>DefaultLimitMEMLOCK=infinity”&gt;&gt; /etc/systemd/system.conf</p>
<p>easticsearch</p>
<p>导入repo</p>
<h1 id="ssh-192-168-0-130-rpm-—import-https-artifacts-elastic-co-GPG-KEY-elasticsearch"><a href="#ssh-192-168-0-130-rpm-—import-https-artifacts-elastic-co-GPG-KEY-elasticsearch" class="headerlink" title="ssh 192.168.0.130 rpm —import https://artifacts.elastic.co/GPG-KEY-elasticsearch"></a>ssh 192.168.0.130 rpm —import <a href="https://artifacts.elastic.co/GPG-KEY-elasticsearch" target="_blank" rel="noopener">https://artifacts.elastic.co/GPG-KEY-elasticsearch</a></h1><p>vim /etc/yum.repos.d/easticsearch-7.repo<br>[elasticsearch-7.x]<br>name=Elasticsearch repository for 7.x packages<br>baseurl=<a href="https://artifacts.elastic.co/packages/7.x/yum" target="_blank" rel="noopener">https://artifacts.elastic.co/packages/7.x/yum</a><br>gpgcheck=1<br>gpgkey=<a href="https://artifacts.elastic.co/GPG-KEY-elasticsearch" target="_blank" rel="noopener">https://artifacts.elastic.co/GPG-KEY-elasticsearch</a><br>enabled=1<br>autorefresh=1<br>type=rpm-md</p>
<p>scp ./easticsearch-7.repo 192.168.0.130:/etc/yum.repos.d/</p>
<p>ssh 192.168.0.130 yum -y install elasticsearch</p>
<p>wget <a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.2.0-x86_64.rpm" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.2.0-x86_64.rpm</a><br>wget <a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.2.0-x86_64.rpm.sha512" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.2.0-x86_64.rpm.sha512</a><br>shasum -a 512 -c elasticsearch-7.2.0-x86_64.rpm.sha512<br>rpm -ivh elasticsearch-7.2.0-x86_64.rpm</p>
<h2 id="单机配置"><a href="#单机配置" class="headerlink" title="单机配置"></a>单机配置</h2><p>path.data: /data/lib/elasticsearch<br>path.logs: /data/log/elasticsearch</p>
<hr>
<p>mkdir /data/lib/elasticsearch -p<br>mkdir  /data/log/elasticsearch -p</p>
<h2 id="vim-etc-elasticsearch-elasticsearch-yml"><a href="#vim-etc-elasticsearch-elasticsearch-yml" class="headerlink" title="vim /etc/elasticsearch/elasticsearch.yml"></a>vim /etc/elasticsearch/elasticsearch.yml</h2><h1 id="集群的名称"><a href="#集群的名称" class="headerlink" title="集群的名称"></a>集群的名称</h1><p>cluster.name: yanqi-clusters</p>
<h1 id="节点的名称"><a href="#节点的名称" class="headerlink" title="节点的名称"></a>节点的名称</h1><p>node.name: es-node-1</p>
<h1 id="是否有资格成为主节点"><a href="#是否有资格成为主节点" class="headerlink" title="是否有资格成为主节点"></a>是否有资格成为主节点</h1><p>node.master: true</p>
<h1 id="是否是数据节点"><a href="#是否是数据节点" class="headerlink" title="是否是数据节点"></a>是否是数据节点</h1><p>node.data: true</p>
<h1 id="数据和日志路径"><a href="#数据和日志路径" class="headerlink" title="数据和日志路径"></a>数据和日志路径</h1><p>path.data: /var/lib/elasticsearch<br>path.logs: /var/log/elasticsearch</p>
<h1 id="设置访问的地址和端口"><a href="#设置访问的地址和端口" class="headerlink" title="设置访问的地址和端口"></a>设置访问的地址和端口</h1><p>network.host: 0.0.0.0<br>http.port: 9200</p>
<h1 id="设置集群中自动发现其它节点时ping连接超时时间，默认为3秒，对于比较差的网络环境可以高点的值来防止自动发现时出错。"><a href="#设置集群中自动发现其它节点时ping连接超时时间，默认为3秒，对于比较差的网络环境可以高点的值来防止自动发现时出错。" class="headerlink" title="设置集群中自动发现其它节点时ping连接超时时间，默认为3秒，对于比较差的网络环境可以高点的值来防止自动发现时出错。"></a>设置集群中自动发现其它节点时ping连接超时时间，默认为3秒，对于比较差的网络环境可以高点的值来防止自动发现时出错。</h1><p>discovery.zen.ping.timeout: 3s</p>
<h1 id="设置是否打开多播发现节点，默认是true。"><a href="#设置是否打开多播发现节点，默认是true。" class="headerlink" title="设置是否打开多播发现节点，默认是true。"></a>设置是否打开多播发现节点，默认是true。</h1><p>discovery.zen.ping.multicast.enabled: false</p>
<h1 id="集群地址设置"><a href="#集群地址设置" class="headerlink" title="集群地址设置"></a>集群地址设置</h1><p>discovery.zen.ping.unicast.hosts: [“192.168.0.130”,”192.168.0.131”,”192.168.0.132”]</p>
<h1 id="设置这个参数来保证集群中的节点可以知道其它N个有master资格的节点。默认为1，对于大的集群来说，可以设置大一点的值（2-4）"><a href="#设置这个参数来保证集群中的节点可以知道其它N个有master资格的节点。默认为1，对于大的集群来说，可以设置大一点的值（2-4）" class="headerlink" title="设置这个参数来保证集群中的节点可以知道其它N个有master资格的节点。默认为1，对于大的集群来说，可以设置大一点的值（2-4）"></a>设置这个参数来保证集群中的节点可以知道其它N个有master资格的节点。默认为1，对于大的集群来说，可以设置大一点的值（2-4）</h1><p>discovery.zen.minimum_master_nodes: 2</p>
<h1 id="设置集群中N个节点启动时进行数据恢复"><a href="#设置集群中N个节点启动时进行数据恢复" class="headerlink" title="设置集群中N个节点启动时进行数据恢复"></a>设置集群中N个节点启动时进行数据恢复</h1><p>gateway.recover_after_nodes: 3</p>
<h1 id="设置初始化数据恢复进程的超时时间，默认是5分钟。"><a href="#设置初始化数据恢复进程的超时时间，默认是5分钟。" class="headerlink" title="设置初始化数据恢复进程的超时时间，默认是5分钟。"></a>设置初始化数据恢复进程的超时时间，默认是5分钟。</h1><p>gateway.recover_after_time: 5m</p>
<h1 id="初始化数据恢复时，并发恢复线程的个数，默认为4。"><a href="#初始化数据恢复时，并发恢复线程的个数，默认为4。" class="headerlink" title="初始化数据恢复时，并发恢复线程的个数，默认为4。"></a>初始化数据恢复时，并发恢复线程的个数，默认为4。</h1><p>cluster.routing.allocation.node_initial_primaries_recoveries: 4</p>
<h1 id="进行内存交换"><a href="#进行内存交换" class="headerlink" title="进行内存交换"></a>进行内存交换</h1><p>bootstrap.memory_lock: true</p>
<h1 id="索引分片个数，默认为5片。"><a href="#索引分片个数，默认为5片。" class="headerlink" title="索引分片个数，默认为5片。"></a>索引分片个数，默认为5片。</h1><p>index.number_of_shards: 5</p>
<h1 id="索引副本个数，默认为1个副本。"><a href="#索引副本个数，默认为1个副本。" class="headerlink" title="索引副本个数，默认为1个副本。"></a>索引副本个数，默认为1个副本。</h1><p>index.number_of_replicas: 1</p>
<p>下面是一些查询时的慢日志参数设置<br>index.search.slowlog.level: TRACE<br>index.search.slowlog.threshold.query.warn: 10s<br>index.search.slowlog.threshold.query.info: 5s<br>index.search.slowlog.threshold.query.debug: 2s<br>index.search.slowlog.threshold.query.trace: 500ms<br>index.search.slowlog.threshold.fetch.warn: 1s<br>index.search.slowlog.threshold.fetch.info: 800ms<br>index.search.slowlog.threshold.fetch.debug:500ms<br>index.search.slowlog.threshold.fetch.trace: 200ms</p>
<hr>
<p>cluster.name: my-application<br>node.name: node-1<br>path.data: /var/lib/elasticsearch<br>path.logs: /var/log/elasticsearch<br>network.host: 0.0.0.0<br>http.port: 9200<br>discovery.seed_hosts: [“host1”, “host2”, “host3”]</p>
<h2 id="cluster-initial-master-nodes-“node-1”-“node-2”-”node-3”"><a href="#cluster-initial-master-nodes-“node-1”-“node-2”-”node-3”" class="headerlink" title="cluster.initial_master_nodes: [“node-1”, “node-2”,”node-3”]"></a>cluster.initial_master_nodes: [“node-1”, “node-2”,”node-3”]</h2><p>cluster.name: my-application<br>node.name: node-2<br>path.data: /var/lib/elasticsearch<br>path.logs: /var/log/elasticsearch<br>network.host: 0.0.0.0<br>http.port: 9200<br>discovery.seed_hosts: [“host1”, “host2”, “host3”]</p>
<h2 id="cluster-initial-master-nodes-“node-1”-“node-2”-”node-3”-1"><a href="#cluster-initial-master-nodes-“node-1”-“node-2”-”node-3”-1" class="headerlink" title="cluster.initial_master_nodes: [“node-1”, “node-2”,”node-3”]"></a>cluster.initial_master_nodes: [“node-1”, “node-2”,”node-3”]</h2><p>cluster.name: my-application<br>node.name: node-3<br>path.data: /var/lib/elasticsearch<br>path.logs: /var/log/elasticsearch<br>network.host: 0.0.0.0<br>http.port: 9200<br>discovery.seed_hosts: [“host1”, “host2”, “host3”]</p>
<h2 id="cluster-initial-master-nodes-“node-1”-“node-2”-”node-3”-2"><a href="#cluster-initial-master-nodes-“node-1”-“node-2”-”node-3”-2" class="headerlink" title="cluster.initial_master_nodes: [“node-1”, “node-2”,”node-3”]"></a>cluster.initial_master_nodes: [“node-1”, “node-2”,”node-3”]</h2><p>开启 Auth 认证功能<br>xpack.security.enabled: true</p>
<p>sudo systemctl daemon-reload<br>sudo systemctl enable elasticsearch.service<br>systemctl start elasticsearch.service</p>
<p>/usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive</p>
<p>sudo systemctl restart elasticsearch.service<br>sudo systemctl restart kibana.service</p>
<h1 id="curl-XGET-‘http-localhost-9200-cluster-state-pretty‘"><a href="#curl-XGET-‘http-localhost-9200-cluster-state-pretty‘" class="headerlink" title="curl -XGET ‘http://localhost:9200/_cluster/state?pretty‘"></a>curl -XGET ‘<a href="http://localhost:9200/_cluster/state?pretty" target="_blank" rel="noopener">http://localhost:9200/_cluster/state?pretty</a>‘</h1><p>curl -XGET ‘localhost:9200/_cluster/health?pretty’<br>curl -XGET “127.0.0.1:9200”</p>
<p>elasticsearch-head<br>git clone git://github.com/mobz/elasticsearch-head.git<br>cd elasticsearch-head<br>npm install<br>npm run start<br>curl <a href="http://localhost:9100/" target="_blank" rel="noopener">http://localhost:9100/</a></p>
<p>yum -y install kibana<br>/etc/kibana/kibana.yml<br>server.port: 5601<br>server.host: “0.0.0.0”<br>elasticsearch.hosts: [“<a href="http://127.0.0.1:9200" target="_blank" rel="noopener">http://127.0.0.1:9200</a>“]<br>sudo systemctl daemon-reload<br>sudo systemctl enable kibana.service<br>sudo systemctl start kibana.service</p>
<p>安装分词插件<br>/usr/share/elasticsearch/bin/elasticsearch-plugin install <a href="https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.3.2/elasticsearch-analysis-ik-6.3.2.zip" target="_blank" rel="noopener">https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.3.2/elasticsearch-analysis-ik-6.3.2.zip</a></p>
<p>日志查看<br>tail -200f /var/log/elasticsearch/yanqi-clusters.log</p>
<p>logstash<br><a href="https://www.elastic.co/downloads/logstash" target="_blank" rel="noopener">https://www.elastic.co/downloads/logstash</a><br>yum install logstash</p>
<p>bin/logstash -f logstash-simple.conf</p>
<p>input { stdin { } }<br>output {<br>  elasticsearch { hosts =&gt; [“localhost:9200”] }<br>  stdout { codec =&gt; rubydebug }<br>}</p>
<p>bin/logstash -e ‘input { stdin { } } output { stdout {} }’</p>
<h2 id="stdout-codec-gt-rubydebug-的意思是输出到控制台"><a href="#stdout-codec-gt-rubydebug-的意思是输出到控制台" class="headerlink" title="stdout { codec =&gt; rubydebug }的意思是输出到控制台"></a>stdout { codec =&gt; rubydebug }的意思是输出到控制台</h2><p>input {<br>    beats {<br>        port =&gt; “5044”<br>    }<br>}<br>filter {<br>    grok {<br>        match =&gt; { “message” =&gt; “%{COMBINEDAPACHELOG}”}<br>    }<br>}<br>output {</p>
<pre><code>stdout { codec =&gt; rubydebug }
</code></pre><h2 id><a href="#" class="headerlink" title="}"></a>}</h2><p> elasticsearch {<br>        hosts =&gt; [ “localhost:9200” ]<br>    }<br>geoip {<br>        source =&gt; “clientip”<br>    }</p>
<p>bin/logstash -f logstash.conf</p>
<p>filebeat<br>filebeat -&gt; logstash<br>              -&gt; elasticsearch<br><a href="https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.2.0-x86_64.rpm" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.2.0-x86_64.rpm</a><br>rpm -ivh <a href="https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.2.0-x86_64.rpm" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.2.0-x86_64.rpm</a></p>
<p>rpm -ivh filebeat-7.2.0-x86_64.rpm</p>
<h2 id="vim-filebeat-yml"><a href="#vim-filebeat-yml" class="headerlink" title="vim filebeat.yml"></a>vim filebeat.yml</h2><p>filebeat.inputs:</p>
<ul>
<li>type: log<br>enabled: false<br>paths:<ul>
<li>/data/log/java_web/ota-whitelist-service/ota-whitelist-service.2019-07-05.log<br>filebeat.config.modules:<br>path: ${path.config}/modules.d/*.yml<br>reload.enabled: false<br>setup.template.settings:<br>index.number_of_shards: 1<br>setup.kibana:<br>host: “119.84.8.44:60117”<br>output.elasticsearch:<br>hosts: [“119.84.8.44:60116”]<br>output.logstash:<br>hosts: [“119.84.8.44:60118”]<h1 id="processors"><a href="#processors" class="headerlink" title="processors:"></a>processors:</h1><h1 id="add-host-metadata"><a href="#add-host-metadata" class="headerlink" title="- add_host_metadata: ~"></a>- add_host_metadata: ~</h1><h1 id="add-cloud-metadata"><a href="#add-cloud-metadata" class="headerlink" title="- add_cloud_metadata: ~"></a>- add_cloud_metadata: ~</h1></li>
</ul>
</li>
</ul>
<p>systemctl  start filebeat</p>
<p>filebeat -e 直接输出到控制台</p>
<h2 id="filebeat-e-c-filebeat-yml-d-“publish”"><a href="#filebeat-e-c-filebeat-yml-d-“publish”" class="headerlink" title="./filebeat -e -c filebeat.yml -d “publish”"></a>./filebeat -e -c filebeat.yml -d “publish”</h2><p>filebeat setup -e \<br>  -E output.logstash.enabled=false \<br>  -E output.elasticsearch.hosts=[“119.84.8.44:60116”] \<br>  -E setup.kibana.host=119.84.8.44:60117</p>
<p>./filebeat setup —template -E output.logstash.enabled=false \<br>-E ‘output.elasticsearch.hosts=[“119.84.8.44:60116”]’</p>
<p><a href="https://github.com/mobz/elasticsearch-head" target="_blank" rel="noopener">https://github.com/mobz/elasticsearch-head</a><br>git clone git://github.com/mobz/elasticsearch-head.git<br>cd elasticsearch-head<br>npm install<br>npm run start</p>
<p>grunt server</p>
<p>http.cors.enabled: true<br>http.cors.allow-origin: “*”<br>http.cors.allow-credentials: true</p>
<p><a href="http://192.168.0.130:9200" target="_blank" rel="noopener">http://192.168.0.130:9200</a> 点击连接</p>
<p>2019-07-05 00:23:32.965 INFO  - status:1,time:1947ms,request:KUL-SGN|20190815/|ctripDirect2016331|ABUS_F@IU3D|162257411018198086|1785362763|1</p>
<p>“%{DATA:date} %{DATA:time} %{DATA:level} %{DATA:-} %{DATA:status},%{DATA:delay},%{DATA:airline}”|%{DATA:startdt}|%{DATA:cid}|%{DATA:ipcc}”</p>
<p>DATA是logstash定义好的正则</p>
<p>overwrite =&gt; [“message”]<br>remove_field  =&gt; “message”<br>add_field =&gt; { “shortHostname” =&gt; “%{hostname[0]}” }<br>rename =&gt; [“shortHostname”, “hostname” ]</p>
<p><a href="https://doc.yonyoucloud.com/doc/logstash-best-practice-cn/filter/grok.html" target="_blank" rel="noopener">https://doc.yonyoucloud.com/doc/logstash-best-practice-cn/filter/grok.html</a><br><a href="http://grokdebug.herokuapp.com/" target="_blank" rel="noopener">http://grokdebug.herokuapp.com/</a></p>
<p>match =&gt; [<br>    “message”, “(?<request_time>\d+(?:.\d+)?)”,<br>    “message”, “%{SYSLOGBASE} %{DATA:message}”,<br>    “message”, “(?m)%{WORD}”<br>]</request_time></p>
<p>{<br>    “input” =&gt; {<br>        “type” =&gt; “log”<br>    },<br>     “date” =&gt; “2019-07-05”,<br>     “time” =&gt; “00:24:32.708”,<br>     “tags” =&gt; [<br>        [0] “beats_input_codec_plain_applied”<br>    ],<br>     “host” =&gt; {<br>        “name” =&gt; “xc1-1”<br>    },<br>      “log” =&gt; {<br>        “offset” =&gt; 27560723,<br>          “file” =&gt; {<br>            “path” =&gt; “/data/log/java_web/ota-whitelist-service/ota-whitelist-service.2019-07-05.log”<br>        }<br>    },<br>      “ecs” =&gt; {<br>        “version” =&gt; “1.0.0”<br>    }<br>}</p>
<hr>
<p>input {<br>    beats {<br>        port =&gt; “5044”<br>    }<br>}<br>filter {<br>    grok{<br>        remove_field =&gt;”@timestamp”<br>        remove_field =&gt;”log”<br>        remove_field =&gt;”input”<br>        remove_field =&gt;”tag”<br>        remove_field =&gt;”ecs”<br>        remove_field =&gt;”tags”<br>        remove_field =&gt; “agent”<br>        remove_field =&gt;”@version”<br>        match =&gt; {<br>            “message” =&gt; “”<br>        }<br>    }<br>}<br>output {<br>    elasticsearch {<br>        index =&gt; “whitelog”<br>        hosts =&gt; [ “119.84.8.44:60116” ]<br>    }</p>
<h2 id="-1"><a href="#-1" class="headerlink" title="}"></a>}</h2><p>119.84.8.44:60116 elasticsearch<br>119.84.8.44:60117 kibana</p>
<h2 id="单机"><a href="#单机" class="headerlink" title="单机"></a>单机</h2><p>curl -L -O <a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.2.0-linux-x86_64.tar.gz" target="_blank" rel="noopener">https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.2.0-linux-x86_64.tar.gz</a><br>tar -xvf elasticsearch-7.2.0-linux-x86_64.tar.gz<br>cd elasticsearch-7.2.0/bin<br>./elasticsearch</p>
<hr>
<p>“patterns”: [“%{IP:client} %{WORD:method} %{URIPATHPARAM:request} %{NUMBER:bytes} %{NUMBER:duration}”],</p>
<h2 id="ingest-对数据分字段"><a href="#ingest-对数据分字段" class="headerlink" title="ingest 对数据分字段"></a>ingest 对数据分字段</h2><h2 id="curl-H-‘Content-Type-application-json’-XPUT-‘http-119-84-8-44-60116-ingest-pipeline-test-pipeline‘-d-pipeline-json"><a href="#curl-H-‘Content-Type-application-json’-XPUT-‘http-119-84-8-44-60116-ingest-pipeline-test-pipeline‘-d-pipeline-json" class="headerlink" title="curl -H ‘Content-Type: application/json’ -XPUT ‘http://119.84.8.44:60116/_ingest/pipeline/test-pipeline‘ -d@pipeline.json"></a>curl -H ‘Content-Type: application/json’ -XPUT ‘<a href="http://119.84.8.44:60116/_ingest/pipeline/test-pipeline" target="_blank" rel="noopener">http://119.84.8.44:60116/_ingest/pipeline/test-pipeline</a>‘ -d@pipeline.json</h2><p>{<br>  “description” : “test desc”,<br>  “processors”: [<br>    {<br>      “grok”: {<br>“field”: “message”,<br>        “patterns”: [“au<em>:%{NUMBER:au</em>}  9c<em>:%{NUMBER:9c</em>}  lcbx<em>f:%{NUMBER:lcbx_f}  lcjc_f:%{NUMBER:lcjc_f}  lcmm_f:%{NUMBER:lcmm_f}  lc6e_f:%{NUMBER:lc6e_f}  lcae_f:%{NUMBER:lcae_f}  lcub_f:%{NUMBER:lcub_f}  lc5j_f:%{NUMBER:lc5j_f}  lcij_f:%{NUMBER:lcij_f}  lcsg_f:%{NUMBER:lcsg_f}  lcfr_f:%{NUMBER:lcfr_f}  lcsl_f:%{NUMBER:lcsl_f}  lcbs_f:%{NUMBER:lcbs_f}  lcvj_f:%{NUMBER:lcvj_f}  vtae:%{NUMBER:vtae}  lcjt_f:%{NUMBER:lcjt_f} “]<br>      }<br>    },<br>    {<br>        “remove”: {<br>        “field”: [“agent”, “log”,”message”,”ecs”,”host”,”input”]<br>        }<br>    },<br>    {<br>    “convert” : {<br>        “field” : “au</em>“,<br>        “type”: “integer”<br>    }<br>    }<br>  ]<br>}</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">yan qi</p>
  <div class="site-description" itemprop="description">君子学以聚之，问以辩之，宽以居之，仁以行之。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">227</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">41</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2017 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">by yanqi.</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">521k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">7:54</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
